using Std::Test::Assertions::*
using Std::Test::*

describe "DateTime", ->
	context "singleton", ->
		context "now", ->
			should "return current time", ->
				t := DateTime.now
				assert! t <: DateTime
				assert! t.year > 2024
				assert! t.month > 0
				assert! t.day > 0
				assert! t.hour >= 0
				assert! t.minute >= 0
				assert! t.second >= 0
			end
		end

		context "parse", ->
			should "parse the default format", ->
				t := DateTime.parse("2025-12-23 19:22:05.000000000 +00:00")
				assert! t <<: DateTime
				assert! t.to_string == "2025-12-23 19:22:05.000000000 +00:00"
				assert! t.year == 2025
				assert! t.month == 12
				assert! t.day == 23
				assert! t.hour == 19
				assert! t.minute == 22
				assert! t.second == 5
				assert! t.zone == Timezone::UTC
			end

			should "parse a custom format", ->
				t := DateTime.parse("23.12.2025 19:22:05 UTC", '%d.%m.%Y %H:%M:%S %#Z')
				assert! t <<: DateTime
				assert! t.to_string == "2025-12-23 19:22:05.000000000 +00:00"
				assert! t.year == 2025
				assert! t.month == 12
				assert! t.day == 23
				assert! t.hour == 19
				assert! t.minute == 22
				assert! t.second == 5
				assert! t.zone == Timezone::UTC
			end

			context "iso year", ->
				context "zero padded", ->
					should "parse repeated year", ->
						t := DateTime.parse("2025 10 2024 2 UTC", '%G %V %G %u %#Z')
						assert! t <<: DateTime
						assert! t.to_string == "2024-03-12 00:00:00.000000000 +00:00"
						assert! t.year == 2024
						assert! t.month == 3
						assert! t.day == 12
					end

					should "parse all digits", ->
						t := DateTime.parse("2025 UTC", '%G %#Z')
						assert! t <<: DateTime
						assert! t.to_string == "2024-12-30 00:00:00.000000000 +00:00"
						assert! t.year == 2024
						assert! t.month == 12
						assert! t.day == 30
					end

					should "parse one digit", ->
						t := DateTime.parse("7 UTC", '%G %#Z')
						assert! t <<: DateTime
						assert! t.to_string == "0007-01-01 00:00:00.000000000 +00:00"
						assert! t.year == 7
						assert! t.month == 1
						assert! t.day == 1
					end

					should "parse with leading zero", ->
						t := DateTime.parse("0507 UTC", '%G %#Z')
						assert! t <<: DateTime
						assert! t.to_string == "0507-01-03 00:00:00.000000000 +00:00"
						assert! t.year == 507
						assert! t.month == 1
						assert! t.day == 3
					end

					should "raise format error for leading space", ->
						assert_throws! DateTime.parse(" 7", "%G") match FormatError(message: 'date format string `"%G"` is incompatible with parsed input `" 7"`')
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%G") match FormatError(message: 'date format string `"%G"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%G") match FormatError(message: 'date format string `"%G"` is incompatible with parsed input `"foo"`')
					end
				end

				context "no padding", ->
					should "parse all digits", ->
						t := DateTime.parse("2025 UTC", '%-G %#Z')
						assert! t <<: DateTime
						assert! t.to_string == "2024-12-30 00:00:00.000000000 +00:00"
						assert! t.year == 2024
						assert! t.month == 12
						assert! t.day == 30
					end

					should "parse one digit", ->
						t := DateTime.parse("7 UTC", '%-G %#Z')
						assert! t <<: DateTime
						assert! t.to_string == "0007-01-01 00:00:00.000000000 +00:00"
						assert! t.year == 7
						assert! t.month == 1
						assert! t.day == 1
					end

					should "parse with leading zero", ->
						t := DateTime.parse("0507 UTC", '%-G %#Z')
						assert! t <<: DateTime
						assert! t.to_string == "0507-01-03 00:00:00.000000000 +00:00"
						assert! t.year == 507
						assert! t.month == 1
						assert! t.day == 3
					end

					should "raise format error for leading space", ->
						assert_throws! DateTime.parse(" 7", "%-G") match FormatError(message: 'date format string `"%-G"` is incompatible with parsed input `" 7"`')
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%-G") match FormatError(message: 'date format string `"%-G"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%-G") match FormatError(message: 'date format string `"%-G"` is incompatible with parsed input `"foo"`')
					end
				end

				context "space padded", ->
					should "parse all digits", ->
						t := DateTime.parse("2025 UTC", '%_G %#Z')
						assert! t <<: DateTime
						assert! t.to_string == "2024-12-30 00:00:00.000000000 +00:00"
						assert! t.year == 2024
						assert! t.month == 12
						assert! t.day == 30
					end

					should "parse one digit", ->
						t := DateTime.parse("7 UTC", '%_G %#Z')
						assert! t <<: DateTime
						assert! t.to_string == "0007-01-01 00:00:00.000000000 +00:00"
						assert! t.year == 7
						assert! t.month == 1
						assert! t.day == 1
					end

					should "parse with leading zero", ->
						t := DateTime.parse("0507 UTC", '%_G %#Z')
						assert! t <<: DateTime
						assert! t.to_string == "0507-01-03 00:00:00.000000000 +00:00"
						assert! t.year == 507
						assert! t.month == 1
						assert! t.day == 3
					end

					should "parse with leading space", ->
						t := DateTime.parse(" 507 UTC", '%_G %#Z')
						assert! t <<: DateTime
						assert! t.to_string == "0507-01-03 00:00:00.000000000 +00:00"
						assert! t.year == 507
						assert! t.month == 1
						assert! t.day == 3
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", '%_G %#Z') match FormatError(message: 'date format string `"%_G %\#Z"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", '%_G %#Z') match FormatError(message: 'date format string `"%_G %\#Z"` is incompatible with parsed input `"foo"`')
					end
				end
			end

			context "year", ->
				context "zero padded", ->
					should "parse repeated year", ->
						t := DateTime.parse("2025 10 2024 2 UTC", '%Y %m %Y %d %#Z')
						assert! t <<: DateTime
						assert! t.to_string == "2024-10-02 00:00:00.000000000 +00:00"
						assert! t.year == 2024
						assert! t.month == 10
						assert! t.day == 2
					end

					should "parse all digits", ->
						t := DateTime.parse("2025", '%Y')
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^2025-\d{2}-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == 2025
						assert! t.month == now.month
						assert! t.day == now.day
						assert! t.zone == Timezone::LOCAL
					end

					should "parse one digit", ->
						t := DateTime.parse("7", '%Y')
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^0007-\d{2}-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == 7
						assert! t.month == now.month
						assert! t.day == now.day
					end

					should "parse with leading zero", ->
						t := DateTime.parse("0507", "%Y")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^0507-\d{2}-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == 507
						assert! t.month == now.month
						assert! t.day == now.day
					end

					should "raise format error for leading space", ->
						assert_throws! DateTime.parse(" 7", "%Y") match FormatError(message: 'date format string `"%Y"` is incompatible with parsed input `" 7"`')
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%Y") match FormatError(message: 'date format string `"%Y"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%Y") match FormatError(message: 'date format string `"%Y"` is incompatible with parsed input `"foo"`')
					end
				end

				context "no padding", ->
					should "parse all digits", ->
						t := DateTime.parse("2025", "%-Y")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^2025-\d{2}-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$$/

						assert! t.year == 2025
						assert! t.month == now.month
						assert! t.day == now.day
					end

					should "parse one digit", ->
						t := DateTime.parse("7", "%-Y")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^0007-\d{2}-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == 7
						assert! t.month == now.month
						assert! t.day == now.day
					end

					should "parse with leading zero", ->
						t := DateTime.parse("0507", "%-Y")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^0507-\d{2}-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == 507
						assert! t.month == now.month
						assert! t.day == now.day
					end

					should "raise format error for leading space", ->
						assert_throws! DateTime.parse(" 7", "%-Y") match FormatError(message: 'date format string `"%-Y"` is incompatible with parsed input `" 7"`')
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%-Y") match FormatError(message: 'date format string `"%-Y"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%-Y") match FormatError(message: 'date format string `"%-Y"` is incompatible with parsed input `"foo"`')
					end
				end

				context "space padded", ->
					should "parse all digits", ->
						t := DateTime.parse("2025", "%_Y")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^2025-\d{2}-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == 2025
						assert! t.month == now.month
						assert! t.day == now.day
					end

					should "parse one digit", ->
						t := DateTime.parse("7", "%_Y")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^0007-\d{2}-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == 7
						assert! t.month == now.month
						assert! t.day == now.day
					end

					should "parse with leading zero", ->
						t := DateTime.parse("0507", "%_Y")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^0507-\d{2}-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == 507
						assert! t.month == now.month
						assert! t.day == now.day
					end

					should "parse with leading space", ->
						t := DateTime.parse(" 507", "%_Y")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^0507-\d{2}-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == 507
						assert! t.month == now.month
						assert! t.day == now.day
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%_Y") match FormatError(message: 'date format string `"%_Y"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%_Y") match FormatError(message: 'date format string `"%_Y"` is incompatible with parsed input `"foo"`')
					end
				end
			end

			context "century", ->
				context "zero padded", ->
					should "parse repeated century", ->
						t := DateTime.parse("20 10 21 35 UTC", '%C %m %C %y %#Z')
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string == "2135-10-01 00:00:00.000000000 +00:00"

						assert! t.year == 2135
						assert! t.month == 10
						assert! t.day == 1
					end

					should "parse all digits", ->
						t := DateTime.parse("20 UTC", '%C %#Z')
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^2000-\d{2}-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == 2000
						assert! t.month == now.month
						assert! t.day == now.day
					end

					should "parse one digit", ->
						t := DateTime.parse("7 UTC", '%C %#Z')
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^0700-\d{2}-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == 700
						assert! t.month == now.month
						assert! t.day == now.day
					end

					should "parse with leading zero", ->
						t := DateTime.parse("05 UTC", '%C %#Z')
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^0500-\d{2}-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == 500
						assert! t.month == now.month
						assert! t.day == now.day
					end

					should "raise format error for leading space", ->
						assert_throws! DateTime.parse(" 7", "%C") match FormatError(message: 'date format string `"%C"` is incompatible with parsed input `" 7"`')
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%C") match FormatError(message: 'date format string `"%C"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%C") match FormatError(message: 'date format string `"%C"` is incompatible with parsed input `"foo"`')
					end
				end

				context "no padding", ->
					should "parse all digits", ->
						t := DateTime.parse("25 UTC", '%-C %#Z')
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^2500-\d{2}-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == 2500
						assert! t.month == now.month
						assert! t.day == now.day
					end

					should "parse one digit", ->
						t := DateTime.parse("7 UTC", '%-C %#Z')
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^0700-\d{2}-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == 700
						assert! t.month == now.month
						assert! t.day == now.day
					end

					should "parse with leading zero", ->
						t := DateTime.parse("05 UTC", '%-C %#Z')
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^0500-\d{2}-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == 500
						assert! t.month == now.month
						assert! t.day == now.day
					end

					should "raise format error for leading space", ->
						assert_throws! DateTime.parse(" 7", "%-C") match FormatError(message: 'date format string `"%-C"` is incompatible with parsed input `" 7"`')
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%-C") match FormatError(message: 'date format string `"%-C"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%-C") match FormatError(message: 'date format string `"%-C"` is incompatible with parsed input `"foo"`')
					end
				end

				context "space padded", ->
					should "parse all digits", ->
						t := DateTime.parse("99 UTC", '%_C %#Z')
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^9900-\d{2}-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == 9900
						assert! t.month == now.month
						assert! t.day == now.day
					end

					should "parse one digit", ->
						t := DateTime.parse("7 UTC", '%_C %#Z')
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^0700-\d{2}-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == 700
						assert! t.month == now.month
						assert! t.day == now.day
					end

					should "parse with leading zero", ->
						t := DateTime.parse("05 UTC", '%_C %#Z')
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^0500-\d{2}-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == 500
						assert! t.month == now.month
						assert! t.day == now.day
					end

					should "parse with leading space", ->
						t := DateTime.parse(" 5 UTC", '%_C %#Z')
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^0500-\d{2}-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == 500
						assert! t.month == now.month
						assert! t.day == now.day
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%_C") match FormatError(message: 'date format string `"%_C"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%_C") match FormatError(message: 'date format string `"%_C"` is incompatible with parsed input `"foo"`')
					end
				end
			end

			context "year last two", ->
				context "zero padded", ->
					should "parse repeated year", ->
						t := DateTime.parse("20 10 21 15 UTC", '%y %m %y %d %#Z')
						assert! t <<: DateTime
						assert! t.to_string == "2021-10-15 00:00:00.000000000 +00:00"
						assert! t.year == 2021
						assert! t.month == 10
						assert! t.day == 15
					end

					should "parse all digits", ->
						t := DateTime.parse("20 UTC", '%y %#Z')
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{2}20-\d{2}-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.century == now.century
						assert! t.year_last_two == 20
						assert! t.month >= 1
						assert! t.day >= 1
					end

					should "parse one digit", ->
						t := DateTime.parse("7 UTC", '%y %#Z')
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{2}07-\d{2}-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.century == now.century
						assert! t.year_last_two == 7
						assert! t.month == now.month
						assert! t.day == now.day
					end

					should "parse with leading zero", ->
						t := DateTime.parse("05 UTC", '%y %#Z')
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{2}05-\d{2}-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.century == now.century
						assert! t.year_last_two == 5
						assert! t.month == now.month
						assert! t.day == now.day
					end

					should "raise format error for leading space", ->
						assert_throws! DateTime.parse(" 7", "%y") match FormatError(message: 'date format string `"%y"` is incompatible with parsed input `" 7"`')
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%y") match FormatError(message: 'date format string `"%y"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%y") match FormatError(message: 'date format string `"%y"` is incompatible with parsed input `"foo"`')
					end
				end

				context "no padding", ->
					should "parse all digits", ->
						t := DateTime.parse("25", "%-y")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{2}25-\d{2}-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.century == now.century
						assert! t.year_last_two == 25
						assert! t.month == now.month
						assert! t.day == now.day
					end

					should "parse one digit", ->
						t := DateTime.parse("7", "%-y")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{2}07-\d{2}-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.century == now.century
						assert! t.year_last_two == 7
						assert! t.month == now.month
						assert! t.day == now.day
					end

					should "parse with leading zero", ->
						t := DateTime.parse("05", "%-y")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{2}05-\d{2}-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.century == now.century
						assert! t.year_last_two == 5
						assert! t.month == now.month
						assert! t.day == now.day
					end

					should "raise format error for leading space", ->
						assert_throws! DateTime.parse(" 7", "%-y") match FormatError(message: 'date format string `"%-y"` is incompatible with parsed input `" 7"`')
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%-y") match FormatError(message: 'date format string `"%-y"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%-y") match FormatError(message: 'date format string `"%-y"` is incompatible with parsed input `"foo"`')
					end
				end

				context "space padded", ->
					should "parse all digits", ->
						t := DateTime.parse("99", "%_y")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{2}99-\d{2}-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.century == now.century
						assert! t.year_last_two == 99
						assert! t.month >= 1
						assert! t.day >= 1
					end

					should "parse one digit", ->
						t := DateTime.parse("7", "%_y")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{2}07-\d{2}-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.century == now.century
						assert! t.year_last_two == 7
						assert! t.month == now.month
						assert! t.day == now.day
					end

					should "parse with leading zero", ->
						t := DateTime.parse("05", "%_y")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{2}05-\d{2}-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.century == now.century
						assert! t.year_last_two == 5
						assert! t.month == now.month
						assert! t.day == now.day
					end

					should "parse with leading space", ->
						t := DateTime.parse(" 5", "%_y")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{2}05-\d{2}-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.century == now.century
						assert! t.year_last_two == 5
						assert! t.month == now.month
						assert! t.day == now.day
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%_y") match FormatError(message: 'date format string `"%_y"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%_y") match FormatError(message: 'date format string `"%_y"` is incompatible with parsed input `"foo"`')
					end
				end
			end

			context "month", ->
				context "zero padded", ->
					should "parse repeated month", ->
						t := DateTime.parse("10 10 9", "%m %d %m")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-09-10 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == 9
						assert! t.day == 10
					end

					should "parse all digits", ->
						t := DateTime.parse("12", "%m")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-12-01 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == 12
						assert! t.day == 1
					end

					should "parse one digit", ->
						t := DateTime.parse("7", "%m")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-07-01 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == 7
						assert! t.day == 1
					end

					should "parse with leading zero", ->
						t := DateTime.parse("05", "%m")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-05-01 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == 5
						assert! t.day == 1
					end

					should "raise format error when > 12", ->
						assert_throws! DateTime.parse("13", "%m") match FormatError(message: "value for date month out of range: 13")
					end

					should "raise format error when < 1", ->
						assert_throws! DateTime.parse("0", "%m") match FormatError(message: "value for date month out of range: 0")
					end

					should "raise format error for leading space", ->
						assert_throws! DateTime.parse(" 7", "%m") match FormatError(message: 'date format string `"%m"` is incompatible with parsed input `" 7"`')
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%m") match FormatError(message: 'date format string `"%m"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%m") match FormatError(message: 'date format string `"%m"` is incompatible with parsed input `"foo"`')
					end
				end

				context "no padding", ->
					should "parse all digits", ->
						t := DateTime.parse("11", "%-m")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-11-01 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == 11
						assert! t.day == 1
					end

					should "parse one digit", ->
						t := DateTime.parse("7", "%-m")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-07-01 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == 7
						assert! t.day == 1
					end

					should "parse with leading zero", ->
						t := DateTime.parse("05", "%-m")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-05-01 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == 5
						assert! t.day == 1
					end

					should "raise format error for leading space", ->
						assert_throws! DateTime.parse(" 7", "%-m") match FormatError(message: 'date format string `"%-m"` is incompatible with parsed input `" 7"`')
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%-m") match FormatError(message: 'date format string `"%-m"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%-m") match FormatError(message: 'date format string `"%-m"` is incompatible with parsed input `"foo"`')
					end
				end

				context "space padded", ->
					should "parse all digits", ->
						t := DateTime.parse("11", "%_m")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-11-01 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == 11
						assert! t.day == 1
					end

					should "parse one digit", ->
						t := DateTime.parse("7", "%_m")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-07-01 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == 7
						assert! t.day == 1
					end

					should "parse with leading zero", ->
						t := DateTime.parse("05", "%_m")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-05-01 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == 5
						assert! t.day == 1
					end

					should "parse with leading space", ->
						t := DateTime.parse(" 5", "%_m")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-05-01 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == 5
						assert! t.day == 1
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%_m") match FormatError(message: 'date format string `"%_m"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%_m") match FormatError(message: 'date format string `"%_m"` is incompatible with parsed input `"foo"`')
					end
				end
			end

			context "month full name", ->
				should "parse repeated month", ->
					t := DateTime.parse("February 10 March", "%B %d %B")
					assert! t <<: DateTime
					now := DateTime.now

					assert! t.to_string match %/^\d{4}-03-10 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

					assert! t.year == now.year
					assert! t.month == 3
					assert! t.day == 10
				end

				should "parse uppercase", ->
					t := DateTime.parse("DECEMBER", "%B")
					assert! t <<: DateTime
					now := DateTime.now

					assert! t.to_string match %/^\d{4}-12-01 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

					assert! t.year == now.year
					assert! t.month == 12
					assert! t.day == 1
				end

				should "parse lowercase", ->
					t := DateTime.parse("november", "%B")
					assert! t <<: DateTime
					now := DateTime.now

					assert! t.to_string match %/^\d{4}-11-01 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

					assert! t.year == now.year
					assert! t.month == 11
					assert! t.day == 1
				end

				should "parse mixed case", ->
					t := DateTime.parse("AUguST", "%B")
					assert! t <<: DateTime
					now := DateTime.now

					assert! t.to_string match %/^\d{4}-08-01 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

					assert! t.year == now.year
					assert! t.month == 8
					assert! t.day == 1
				end

				should "raise format error for invalid month name", ->
					assert_throws! DateTime.parse("Buja", "%B") match FormatError(message: "invalid date month name: buja")
				end

				should "raise format error for no text", ->
					assert_throws! DateTime.parse("", "%B") match FormatError(message: 'invalid date month name: ')
				end
			end

			context "month abbreviated name", ->
				should "parse repeated month", ->
					t := DateTime.parse("Feb 10 Mar", "%b %d %b")
					assert! t <<: DateTime
					now := DateTime.now

					assert! t.to_string match %/^\d{4}-03-10 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

					assert! t.year == now.year
					assert! t.month == 3
					assert! t.day == 10
				end

				should "parse uppercase", ->
					t := DateTime.parse("DEC", "%b")
					assert! t <<: DateTime
					now := DateTime.now

					assert! t.to_string match %/^\d{4}-12-01 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

					assert! t.year == now.year
					assert! t.month == 12
					assert! t.day == 1
				end

				should "parse lowercase", ->
					t := DateTime.parse("nov", "%b")
					assert! t <<: DateTime
					now := DateTime.now

					assert! t.to_string match %/^\d{4}-11-01 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

					assert! t.year == now.year
					assert! t.month == 11
					assert! t.day == 1
				end

				should "parse mixed case", ->
					t := DateTime.parse("AuG", "%b")
					assert! t <<: DateTime
					now := DateTime.now

					assert! t.to_string match %/^\d{4}-08-01 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

					assert! t.year == now.year
					assert! t.month == 8
					assert! t.day == 1
				end

				should "raise format error for invalid month name", ->
					assert_throws! DateTime.parse("Buj", "%b") match FormatError(message: "invalid date abbreviated month name: buj")
				end

				should "raise format error for no text", ->
					assert_throws! DateTime.parse("", "%b") match FormatError(message: 'invalid date abbreviated month name: ')
				end
			end

			context "day of month", ->
				context "zero padded", ->
					should "parse repeated day", ->
						t := DateTime.parse("21 9 13", "%d %m %d")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-09-13 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == 9
						assert! t.day == 13
					end

					should "parse all digits", ->
						t := DateTime.parse("12", "%d")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-\d{2}-12 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == now.month
						assert! t.day == 12
					end

					should "parse one digit", ->
						t := DateTime.parse("7", "%d")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-\d{2}-07 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == now.month
						assert! t.day == 7
					end

					should "parse with leading zero", ->
						t := DateTime.parse("05", "%d")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-\d{2}-05 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == now.month
						assert! t.day == 5
					end

					should "raise format error for leading space", ->
						assert_throws! DateTime.parse(" 7", "%d") match FormatError(message: 'date format string `"%d"` is incompatible with parsed input `" 7"`')
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%d") match FormatError(message: 'date format string `"%d"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%d") match FormatError(message: 'date format string `"%d"` is incompatible with parsed input `"foo"`')
					end
				end

				context "no padding", ->
					should "parse all digits", ->
						t := DateTime.parse("11", "%-d")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-\d{2}-11 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == now.month
						assert! t.day == 11
					end

					should "parse one digit", ->
						t := DateTime.parse("7", "%-d")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-\d{2}-07 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == now.month
						assert! t.day == 7
					end

					should "parse with leading zero", ->
						t := DateTime.parse("05", "%-d")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-\d{2}-05 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == now.month
						assert! t.day == 5
					end

					should "raise format error for leading space", ->
						assert_throws! DateTime.parse(" 7", "%-d") match FormatError(message: 'date format string `"%-d"` is incompatible with parsed input `" 7"`')
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%-d") match FormatError(message: 'date format string `"%-d"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%-d") match FormatError(message: 'date format string `"%-d"` is incompatible with parsed input `"foo"`')
					end
				end

				context "space padded", ->
					should "parse all digits", ->
						t := DateTime.parse("11", "%_d")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-\d{2}-11 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == now.month
						assert! t.day == 11
					end

					should "parse one digit", ->
						t := DateTime.parse("7", "%_d")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-\d{2}-07 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == now.month
						assert! t.day == 7
					end

					should "parse with leading zero", ->
						t := DateTime.parse("05", "%_d")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-\d{2}-05 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == now.month
						assert! t.day == 5
					end

					should "parse with leading space", ->
						t := DateTime.parse(" 5", "%_d")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-\d{2}-05 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == now.month
						assert! t.day == 5
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%_d") match FormatError(message: 'date format string `"%_d"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%_d") match FormatError(message: 'date format string `"%_d"` is incompatible with parsed input `"foo"`')
					end
				end
			end

			context "day of year", ->
				context "zero padded", ->
					should "parse repeated day", ->
						t := DateTime.parse("220 12 48 UTC", '%j %y %j %#Z')
						assert! t <<: DateTime

						assert! t.to_string == "2012-02-17 00:00:00.000000000 +00:00"

						assert! t.year == 2012
						assert! t.month == 2
						assert! t.day == 17
					end

					should "parse all digits", ->
						t := DateTime.parse("365", "%j")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-12-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == 12
						assert! t.day >= 30
					end

					should "parse one digit", ->
						t := DateTime.parse("7", "%j")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-01-07 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == 1
						assert! t.day == 7
					end

					should "parse with leading zero", ->
						t := DateTime.parse("07", "%j")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-01-07 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == 1
						assert! t.day == 7
					end

					should "raise format error when > 366", ->
						assert_throws! DateTime.parse("367", "%j") match FormatError(message: "value for date day of year out of range: 367")
					end

					should "raise format error for leading space", ->
						assert_throws! DateTime.parse(" 7", "%j") match FormatError(message: 'date format string `"%j"` is incompatible with parsed input `" 7"`')
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%j") match FormatError(message: 'date format string `"%j"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%j") match FormatError(message: 'date format string `"%j"` is incompatible with parsed input `"foo"`')
					end
				end

				context "no padding", ->
					should "parse all digits", ->
						t := DateTime.parse("365", "%-j")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-12-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == 12
						assert! t.day >= 30
					end

					should "parse one digit", ->
						t := DateTime.parse("7", "%-j")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-01-07 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == 1
						assert! t.day == 7
					end

					should "parse with leading zero", ->
						t := DateTime.parse("22", "%-j")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-01-22 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == 1
						assert! t.day == 22
					end

					should "raise format error for leading space", ->
						assert_throws! DateTime.parse(" 7", "%-j") match FormatError(message: 'date format string `"%-j"` is incompatible with parsed input `" 7"`')
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%-j") match FormatError(message: 'date format string `"%-j"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%-j") match FormatError(message: 'date format string `"%-j"` is incompatible with parsed input `"foo"`')
					end
				end

				context "space padded", ->
					should "parse all digits", ->
						t := DateTime.parse("365", "%_j")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-12-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == 12
						assert! t.day >= 30
					end

					should "parse one digit", ->
						t := DateTime.parse("7", "%_j")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-01-07 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == 1
						assert! t.day == 7
					end

					should "parse with leading zero", ->
						t := DateTime.parse("015", "%_j")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-01-15 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == 1
						assert! t.day == 15
					end

					should "parse with leading space", ->
						t := DateTime.parse(" 5", "%_j")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-\d{2}-05 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == 1
						assert! t.day == 5
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%_j") match FormatError(message: 'date format string `"%_j"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%_j") match FormatError(message: 'date format string `"%_j"` is incompatible with parsed input `"foo"`')
					end
				end
			end

			context "day of week name", ->
				should "parse repeated day of week", ->
					t := DateTime.parse("Tuesday 10 Monday", "%A %d %A")
					assert! t <<: DateTime
					now := DateTime.now

					assert! t.to_string match %/^\d{4}-\d{2}-10 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

					assert! t.year == now.year
					assert! t.month == now.month
					assert! t.day == 10
				end

				should "parse with week", ->
					t := DateTime.parse("15 35 FRIDAY UTC", '%y %W %A %#Z')
					assert! t <<: DateTime
					now := DateTime.now

					assert! t.to_string == "2015-09-04 00:00:00.000000000 +00:00"

					assert! t.year == 2015
					assert! t.month == 9
					assert! t.day == 4
					assert! t.weekday_name == "Friday"
				end

				should "parse uppercase", ->
					t := DateTime.parse("FRIDAY", "%A")
					assert! t <<: DateTime
					now := DateTime.now

					assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

					assert! t.year == now.year
					assert! t.month == now.month
					assert! t.day == now.day
				end

				should "parse lowercase", ->
					t := DateTime.parse("thursday", "%A")
					assert! t <<: DateTime
					now := DateTime.now

					assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

					assert! t.year == now.year
					assert! t.month == now.month
					assert! t.day == now.day
				end

				should "parse mixed case", ->
					t := DateTime.parse("WEDneSdAy", "%A")
					assert! t <<: DateTime
					now := DateTime.now

					assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

					assert! t.year == now.year
					assert! t.month == now.month
					assert! t.day == now.day
				end

				should "raise format error for invalid day name", ->
					assert_throws! DateTime.parse("Buja", "%A") match FormatError(message: "invalid date day of week name: buja")
				end

				should "raise format error for no text", ->
					assert_throws! DateTime.parse("", "%A") match FormatError(message: "invalid date day of week name: ")
				end
			end

			context "day of week abbreviated name", ->
				should "parse repeated month", ->
					t := DateTime.parse("Tue 10 Mon", "%a %d %a")
					assert! t <<: DateTime
					now := DateTime.now

					assert! t.to_string match %/^\d{4}-\d{2}-10 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

					assert! t.year == now.year
					assert! t.month == now.month
					assert! t.day == 10
				end

				should "parse with week", ->
					t := DateTime.parse("15 35 FRI UTC", '%y %W %a %#Z')
					assert! t <<: DateTime
					now := DateTime.now

					assert! t.to_string == "2015-09-04 00:00:00.000000000 +00:00"

					assert! t.year == 2015
					assert! t.month == 9
					assert! t.day == 4
					assert! t.weekday_name == "Friday"
				end

				should "parse uppercase", ->
					t := DateTime.parse("FRI", "%a")
					assert! t <<: DateTime
					now := DateTime.now

					assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

					assert! t.year == now.year
					assert! t.month == now.month
					assert! t.day == now.day
				end

				should "parse lowercase", ->
					t := DateTime.parse("thu", "%a")
					assert! t <<: DateTime
					now := DateTime.now

					assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

					assert! t.year == now.year
					assert! t.month == now.month
					assert! t.day == now.day
				end

				should "parse mixed case", ->
					t := DateTime.parse("WeD", "%a")
					assert! t <<: DateTime
					now := DateTime.now

					assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

					assert! t.year == now.year
					assert! t.month == now.month
					assert! t.day == now.day
				end

				should "raise format error for invalid day name", ->
					assert_throws! DateTime.parse("Buj", "%a") match FormatError(message: "invalid date abbreviated day of week name: buj")
				end

				should "raise format error for no text", ->
					assert_throws! DateTime.parse("", "%a") match FormatError(message: "invalid date abbreviated day of week name: ")
				end
			end

			context "day of week number", ->
				should "parse repeated day", ->
					t := DateTime.parse("4 15 5 2 UTC", '%u %y %W %u %#Z')
					assert! t <<: DateTime

					assert! t.to_string == "2015-02-03 00:00:00.000000000 +00:00"

					assert! t.year == 2015
					assert! t.month == 2
					assert! t.day == 3
					assert! t.weekday_name == "Tuesday"
				end

				should "parse with week", ->
					t := DateTime.parse("15 35 5 UTC", '%y %W %u %#Z')
					assert! t <<: DateTime
					now := DateTime.now

					assert! t.to_string == "2015-09-04 00:00:00.000000000 +00:00"

					assert! t.year == 2015
					assert! t.month == 9
					assert! t.day == 4
					assert! t.weekday_name == "Friday"
				end

				should "raise format error when > 7", ->
					assert_throws! DateTime.parse("8", "%u") match FormatError(message: "value for date day of week number out of range: 8")
				end

				should "raise format error when < 1", ->
					assert_throws! DateTime.parse("0", "%u") match FormatError(message: "value for date day of week number out of range: 0")
				end

				should "raise format error for no digits", ->
					assert_throws! DateTime.parse("", "%u") match FormatError(message: 'date format string `"%u"` is incompatible with parsed input `""`')
				end

				should "raise format error for text", ->
					assert_throws! DateTime.parse("foo", "%u") match FormatError(message: 'date format string `"%u"` is incompatible with parsed input `"foo"`')
				end
			end

			context "day of week number alt", ->
				should "parse repeated day", ->
					t := DateTime.parse("4 15 5 0 UTC", '%w %y %W %w %#Z')
					assert! t <<: DateTime

					assert! t.to_string == "2015-02-01 00:00:00.000000000 +00:00"

					assert! t.year == 2015
					assert! t.month == 2
					assert! t.day == 1
					assert! t.weekday_name == "Sunday"
				end

				should "parse with week", ->
					t := DateTime.parse("15 35 5 UTC", '%y %W %w %#Z')
					assert! t <<: DateTime
					now := DateTime.now

					assert! t.to_string == "2015-09-04 00:00:00.000000000 +00:00"

					assert! t.year == 2015
					assert! t.month == 9
					assert! t.day == 4
					assert! t.weekday_name == "Friday"
				end

				should "raise format error when > 6", ->
					assert_throws! DateTime.parse("7", "%w") match FormatError(message: "value for date alt day of week number out of range: 7")
				end

				should "raise format error for no digits", ->
					assert_throws! DateTime.parse("", "%w") match FormatError(message: 'date format string `"%w"` is incompatible with parsed input `""`')
				end

				should "raise format error for text", ->
					assert_throws! DateTime.parse("foo", "%w") match FormatError(message: 'date format string `"%w"` is incompatible with parsed input `"foo"`')
				end
			end

			context "iso week", ->
				context "zero padded", ->
					should "parse repeated week", ->
						t := DateTime.parse("26 22 11 UTC", '%V %y %V %#Z')
						assert! t <<: DateTime

						assert! t.to_string == "2022-03-20 00:00:00.000000000 +00:00"

						assert! t.year == 2022
						assert! t.month == 3
						assert! t.day == 20
					end

					should "parse all digits", ->
						t := DateTime.parse("12", "%V")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-03-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == 3
						assert! t.day >= 1
					end

					should "parse one digit", ->
						t := DateTime.parse("2", "%V")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-01-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == 1
						assert! t.day >= 1
					end

					should "parse with leading zero", ->
						t := DateTime.parse("02", "%V")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-01-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == 1
						assert! t.day >= 1
					end

					should "raise format error when > 53", ->
						assert_throws! DateTime.parse("54", "%V") match FormatError(message: "value for ISO week out of range: 54")
					end

					should "raise format error when < 1", ->
						assert_throws! DateTime.parse("0", "%V") match FormatError(message: "value for ISO week out of range: 0")
					end

					should "raise format error for leading space", ->
						assert_throws! DateTime.parse(" 7", "%V") match FormatError(message: 'date format string `"%V"` is incompatible with parsed input `" 7"`')
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%V") match FormatError(message: 'date format string `"%V"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%V") match FormatError(message: 'date format string `"%V"` is incompatible with parsed input `"foo"`')
					end
				end

				context "no padding", ->
					should "parse all digits", ->
						t := DateTime.parse("12", "%-V")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-03-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == 3
						assert! t.day >= 1
					end

					should "parse one digit", ->
						t := DateTime.parse("2", "%-V")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-01-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == 1
						assert! t.day >= 1
					end

					should "parse with leading zero", ->
						t := DateTime.parse("02", "%-V")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-01-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == 1
						assert! t.day >= 1
					end

					should "raise format error for leading space", ->
						assert_throws! DateTime.parse(" 7", "%-V") match FormatError(message: 'date format string `"%-V"` is incompatible with parsed input `" 7"`')
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%-V") match FormatError(message: 'date format string `"%-V"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%-V") match FormatError(message: 'date format string `"%-V"` is incompatible with parsed input `"foo"`')
					end
				end

				context "space padded", ->
					should "parse all digits", ->
						t := DateTime.parse("12", "%_V")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-03-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == 3
						assert! t.day >= 1
					end

					should "parse one digit", ->
						t := DateTime.parse("2", "%_V")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-01-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == 1
						assert! t.day >= 1
					end

					should "parse with leading zero", ->
						t := DateTime.parse("02", "%_V")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-01-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == 1
						assert! t.day >= 1
					end

					should "parse with leading space", ->
						t := DateTime.parse(" 2", "%_V")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-01-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == 1
						assert! t.day >= 1
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%_V") match FormatError(message: 'date format string `"%_V"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%_V") match FormatError(message: 'date format string `"%_V"` is incompatible with parsed input `"foo"`')
					end
				end
			end

			context "week", ->
				context "zero padded", ->
					should "parse repeated week", ->
						t := DateTime.parse("26 22 11 UTC", '%W %y %W %#Z')
						assert! t <<: DateTime

						assert! t.to_string == "2022-03-14 00:00:00.000000000 +00:00"

						assert! t.year == 2022
						assert! t.month == 3
						assert! t.day == 14
						assert! t.weekday_name == "Monday"
					end

					should "parse all digits", ->
						t := DateTime.parse("12", "%W")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-03-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == 3
						assert! t.day >= 1
					end

					should "parse one digit", ->
						t := DateTime.parse("2", "%W")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-01-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == 1
						assert! t.day >= 1
					end

					should "parse with leading zero", ->
						t := DateTime.parse("02", "%W")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-01-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == 1
						assert! t.day >= 1
					end

					should "parse zero", ->
						t := DateTime.parse("0", "%W")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-01-01 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == 1
						assert! t.day == 1
					end

					should "raise format error when > 53", ->
						assert_throws! DateTime.parse("54", "%W") match FormatError(message: "value for week out of range: 54")
					end
					should "raise format error for leading space", ->
						assert_throws! DateTime.parse(" 7", "%W") match FormatError(message: 'date format string `"%W"` is incompatible with parsed input `" 7"`')
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%W") match FormatError(message: 'date format string `"%W"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%W") match FormatError(message: 'date format string `"%W"` is incompatible with parsed input `"foo"`')
					end
				end

				context "no padding", ->
					should "parse all digits", ->
						t := DateTime.parse("12", "%-W")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-03-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == 3
						assert! t.day >= 1
					end

					should "parse one digit", ->
						t := DateTime.parse("2", "%-W")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-01-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == 1
						assert! t.day >= 1
					end

					should "parse with leading zero", ->
						t := DateTime.parse("02", "%-W")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-01-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == 1
						assert! t.day >= 1
					end

					should "raise format error for leading space", ->
						assert_throws! DateTime.parse(" 7", "%-W") match FormatError(message: 'date format string `"%-W"` is incompatible with parsed input `" 7"`')
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%-W") match FormatError(message: 'date format string `"%-W"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%-W") match FormatError(message: 'date format string `"%-W"` is incompatible with parsed input `"foo"`')
					end
				end

				context "space padded", ->
					should "parse all digits", ->
						t := DateTime.parse("12", "%_W")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-03-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == 3
						assert! t.day >= 1
					end

					should "parse one digit", ->
						t := DateTime.parse("2", "%_W")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-01-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == 1
						assert! t.day >= 1
					end

					should "parse with leading zero", ->
						t := DateTime.parse("02", "%_W")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-01-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == 1
						assert! t.day >= 1
					end

					should "parse with leading space", ->
						t := DateTime.parse(" 2", "%_W")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-01-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == 1
						assert! t.day >= 1
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%_W") match FormatError(message: 'date format string `"%_W"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%_W") match FormatError(message: 'date format string `"%_W"` is incompatible with parsed input `"foo"`')
					end
				end
			end

			context "week alt", ->
				context "zero padded", ->
					should "parse repeated week", ->
						t := DateTime.parse("26 22 11 UTC", '%U %y %U %#Z')
						assert! t <<: DateTime

						assert! t.to_string == "2022-03-13 00:00:00.000000000 +00:00"

						assert! t.year == 2022
						assert! t.month == 3
						assert! t.day == 13
						assert! t.weekday_name == "Sunday"
					end

					should "parse all digits", ->
						t := DateTime.parse("12", "%U")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-03-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == 3
						assert! t.day >= 1
					end

					should "parse one digit", ->
						t := DateTime.parse("2", "%U")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-01-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == 1
						assert! t.day >= 1
					end

					should "parse with leading zero", ->
						t := DateTime.parse("02", "%U")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-01-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == 1
						assert! t.day >= 1
					end

					should "parse zero", ->
						t := DateTime.parse("0", "%U")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-01-01 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == 1
						assert! t.day == 1
					end

					should "raise format error when > 53", ->
						assert_throws! DateTime.parse("54", "%U") match FormatError(message: "value for week out of range: 54")
					end
					should "raise format error for leading space", ->
						assert_throws! DateTime.parse(" 7", "%U") match FormatError(message: 'date format string `"%U"` is incompatible with parsed input `" 7"`')
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%U") match FormatError(message: 'date format string `"%U"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%U") match FormatError(message: 'date format string `"%U"` is incompatible with parsed input `"foo"`')
					end
				end

				context "no padding", ->
					should "parse all digits", ->
						t := DateTime.parse("12", "%-U")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-03-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == 3
						assert! t.day >= 1
					end

					should "parse one digit", ->
						t := DateTime.parse("2", "%-U")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-01-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == 1
						assert! t.day >= 1
					end

					should "parse with leading zero", ->
						t := DateTime.parse("02", "%-U")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-01-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == 1
						assert! t.day >= 1
					end

					should "raise format error for leading space", ->
						assert_throws! DateTime.parse(" 7", "%-U") match FormatError(message: 'date format string `"%-U"` is incompatible with parsed input `" 7"`')
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%-U") match FormatError(message: 'date format string `"%-U"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%-U") match FormatError(message: 'date format string `"%-U"` is incompatible with parsed input `"foo"`')
					end
				end

				context "space padded", ->
					should "parse all digits", ->
						t := DateTime.parse("12", "%_U")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-03-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == 3
						assert! t.day >= 1
					end

					should "parse one digit", ->
						t := DateTime.parse("2", "%_U")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-01-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == 1
						assert! t.day >= 1
					end

					should "parse with leading zero", ->
						t := DateTime.parse("02", "%_U")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-01-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == 1
						assert! t.day >= 1
					end

					should "parse with leading space", ->
						t := DateTime.parse(" 2", "%_U")
						assert! t <<: DateTime
						now := DateTime.now

						assert! t.to_string match %/^\d{4}-01-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/

						assert! t.year == now.year
						assert! t.month == 1
						assert! t.day >= 1
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%_U") match FormatError(message: 'date format string `"%_U"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%_U") match FormatError(message: 'date format string `"%_U"` is incompatible with parsed input `"foo"`')
					end
				end
			end

			context "date", ->
				should "parse", ->
					t := DateTime.parse("12/20/02 UTC", '%D %#Z')
					assert! t <<: DateTime
					now := DateTime.now

					assert! t.to_string == "2002-12-20 00:00:00.000000000 +00:00"

					assert! t.year == 2002
					assert! t.month == 12
					assert! t.day == 20
				end

				should "raise format error when incompatible string", ->
					assert_throws! DateTime.parse("54-02-1992", "%D") match FormatError(message: "value for date month out of range: 54")
				end
			end

			context "iso date", ->
				should "parse", ->
					t := DateTime.parse("2002-10-17 UTC", '%F %#Z')
					assert! t <<: DateTime
					now := DateTime.now

					assert! t.to_string == "2002-10-17 00:00:00.000000000 +00:00"

					assert! t.year == 2002
					assert! t.month == 10
					assert! t.day == 17
				end

				should "raise format error when incompatible string", ->
					assert_throws! DateTime.parse("12-02-1992", "%F") match FormatError(message: "datetime format string `\"%F\"` is incompatible with parsed input `\"12-02-1992\"`")
				end
			end

			should "parse a custom format", ->
				t := DateTime.parse("22-15-10:22", "%H-%M-%S:%N")
				assert! t <<: DateTime
				assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 22:15:10\.000000022 (\+|\-)\d{2}:\d{2}$/
				assert! t.hour == 22
				assert! t.minute == 15
				assert! t.second == 10
				assert! t.nanoseconds_in_second == 22
			end

			context "hour", ->
				context "zero padded", ->
					should "parse repeated hours", ->
						t := DateTime.parse("15 25 9 12", "%H %M %S %H")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 12:25:09\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 12
						assert! t.minute == 25
						assert! t.second == 9
					end

					should "parse two digits", ->
						t := DateTime.parse("15", "%H")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 15:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 15
						assert! t.minute == 0
						assert! t.second == 0
					end

					should "parse one digit", ->
						t := DateTime.parse("7", "%H")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 07:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 7
						assert! t.minute == 0
						assert! t.second == 0
					end

					should "parse with leading zero", ->
						t := DateTime.parse("07", "%H")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 07:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 7
						assert! t.minute == 0
						assert! t.second == 0
					end

					should "raise format error for leading space", ->
						assert_throws! DateTime.parse(" 7", "%H") match FormatError(message: 'time format string `"%H"` is incompatible with parsed input `" 7"`')
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%H") match FormatError(message: 'time format string `"%H"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%H") match FormatError(message: 'time format string `"%H"` is incompatible with parsed input `"foo"`')
					end

					should "raise format error for out of bounds", ->
						assert_throws! DateTime.parse("57", "%H") match FormatError(message: 'value for hour out of range: 57')
					end
				end

				context "no padding", ->
					should "parse two digits", ->
						t := DateTime.parse("15", "%-H")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 15:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 15
						assert! t.minute == 0
						assert! t.second == 0
					end

					should "parse one digit", ->
						t := DateTime.parse("7", "%-H")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 07:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 7
						assert! t.minute == 0
						assert! t.second == 0
					end

					should "parse with leading zero", ->
						t := DateTime.parse("07", "%-H")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 07:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 7
						assert! t.minute == 0
						assert! t.second == 0
					end

					should "raise format error for leading space", ->
						assert_throws! DateTime.parse(" 7", "%-H") match FormatError(message: 'time format string `"%-H"` is incompatible with parsed input `" 7"`')
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%-H") match FormatError(message: 'time format string `"%-H"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%-H") match FormatError(message: 'time format string `"%-H"` is incompatible with parsed input `"foo"`')
					end

					should "raise format error for out of bounds", ->
						assert_throws! DateTime.parse("57", "%-H") match FormatError(message: 'value for hour out of range: 57')
					end
				end

				context "space padded", ->
					should "parse two digits", ->
						t := DateTime.parse("15", "%_H")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 15:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 15
						assert! t.minute == 0
						assert! t.second == 0
					end

					should "parse one digit", ->
						t := DateTime.parse("7", "%_H")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 07:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 7
						assert! t.minute == 0
						assert! t.second == 0
					end

					should "parse with leading zero", ->
						t := DateTime.parse("07", "%_H")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 07:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 7
						assert! t.minute == 0
						assert! t.second == 0
					end

					should "parse with leading space", ->
						t := DateTime.parse(" 7", "%_H")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 07:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 7
						assert! t.minute == 0
						assert! t.second == 0
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%_H") match FormatError(message: 'time format string `"%_H"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%_H") match FormatError(message: 'time format string `"%_H"` is incompatible with parsed input `"foo"`')
					end

					should "raise format error for out of bounds", ->
						assert_throws! DateTime.parse("57", "%_H") match FormatError(message: 'value for hour out of range: 57')
					end
				end
			end

			context "hour 12", ->
				context "zero padded", ->
					should "parse repeated hours", ->
						t := DateTime.parse("2 25 9 10", "%I %M %S %I")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 10:25:09\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 10
						assert! t.minute == 25
						assert! t.second == 9
					end

					should "parse two digits", ->
						t := DateTime.parse("10", "%I")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 10:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 10
						assert! t.minute == 0
						assert! t.second == 0
					end

					should "parse one digit", ->
						t := DateTime.parse("7", "%I")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 07:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 7
						assert! t.minute == 0
						assert! t.second == 0
					end

					should "parse with leading zero", ->
						t := DateTime.parse("07", "%I")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 07:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 7
						assert! t.minute == 0
						assert! t.second == 0
					end

					should "raise format error for leading space", ->
						assert_throws! DateTime.parse(" 7", "%I") match FormatError(message: 'time format string `"%I"` is incompatible with parsed input `" 7"`')
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%I") match FormatError(message: 'time format string `"%I"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%I") match FormatError(message: 'time format string `"%I"` is incompatible with parsed input `"foo"`')
					end

					should "raise format error for out of bounds", ->
						assert_throws! DateTime.parse("13", "%I") match FormatError(message: "value for 12 hour out of range: 13")
					end
				end

				context "no padding", ->
					should "parse two digits", ->
						t := DateTime.parse("11", "%-I")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 11:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 11
						assert! t.minute == 0
						assert! t.second == 0
					end

					should "parse one digit", ->
						t := DateTime.parse("7", "%-I")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 07:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 7
						assert! t.minute == 0
						assert! t.second == 0
					end

					should "parse with leading zero", ->
						t := DateTime.parse("07", "%-I")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 07:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 7
						assert! t.minute == 0
						assert! t.second == 0
					end

					should "raise format error for leading space", ->
						assert_throws! DateTime.parse(" 7", "%-I") match FormatError(message: 'time format string `"%-I"` is incompatible with parsed input `" 7"`')
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%-I") match FormatError(message: 'time format string `"%-I"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%-I") match FormatError(message: 'time format string `"%-I"` is incompatible with parsed input `"foo"`')
					end

					should "raise format error for out of bounds", ->
						assert_throws! DateTime.parse("13", "%-I") match FormatError(message: 'value for 12 hour out of range: 13')
					end
				end

				context "space padded", ->
					should "parse two digits", ->
						t := DateTime.parse("9", "%_I")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 09:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 9
						assert! t.minute == 0
						assert! t.second == 0
					end

					should "parse one digit", ->
						t := DateTime.parse("7", "%_I")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 07:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 7
						assert! t.minute == 0
						assert! t.second == 0
					end

					should "parse with leading zero", ->
						t := DateTime.parse("07", "%_I")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 07:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 7
						assert! t.minute == 0
						assert! t.second == 0
					end

					should "parse with leading space", ->
						t := DateTime.parse(" 7", "%_I")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 07:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 7
						assert! t.minute == 0
						assert! t.second == 0
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%_I") match FormatError(message: 'time format string `"%_I"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%_I") match FormatError(message: 'time format string `"%_I"` is incompatible with parsed input `"foo"`')
					end

					should "raise format error for out of bounds", ->
						assert_throws! DateTime.parse("14", "%_I") match FormatError(message: 'value for 12 hour out of range: 14')
					end
				end
			end

			context "meridiem", ->
				context "lowercase", ->
					should "parse 7 am", ->
						t := DateTime.parse("7 am", "%I %P")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 07:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 7
						assert! t.minute == 0
						assert! t.second == 0
					end

					should "parse 7 AM", ->
						t := DateTime.parse("7 AM", "%I %P")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 07:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 7
						assert! t.minute == 0
						assert! t.second == 0
					end

					should "parse 7 pm", ->
						t := DateTime.parse("7 pm", "%I %P")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 19:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 19
						assert! t.minute == 0
						assert! t.second == 0
					end

					should "parse 7 PM", ->
						t := DateTime.parse("7 PM", "%I %P")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 19:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 19
						assert! t.minute == 0
						assert! t.second == 0
					end

					should "parse 12 pm", ->
						t := DateTime.parse("12 pm", "%I %P")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 12:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 12
						assert! t.minute == 0
						assert! t.second == 0
					end

					should "parse 12 am", ->
						t := DateTime.parse("12 am", "%I %P")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
					end

					should "ignore PM when a 24 hour is present", ->
						t := DateTime.parse("15 pm", "%H %P")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 15:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 15
						assert! t.minute == 0
						assert! t.second == 0
					end
				end

				context "uppercase", ->
					should "parse 7 AM", ->
						t := DateTime.parse("7 AM", "%I %p")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 07:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 7
						assert! t.minute == 0
						assert! t.second == 0
					end

					should "parse 7 am", ->
						t := DateTime.parse("7 am", "%I %p")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 07:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 7
						assert! t.minute == 0
						assert! t.second == 0
					end

					should "parse 7 PM", ->
						t := DateTime.parse("7 PM", "%I %p")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 19:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 19
						assert! t.minute == 0
						assert! t.second == 0
					end

					should "parse 7 pm", ->
						t := DateTime.parse("7 pm", "%I %p")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 19:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 19
						assert! t.minute == 0
						assert! t.second == 0
					end

					should "parse 12 PM", ->
						t := DateTime.parse("12 PM", "%I %p")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 12:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 12
						assert! t.minute == 0
						assert! t.second == 0
					end

					should "parse 12 AM", ->
						t := DateTime.parse("12 AM", "%I %p")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
					end

					should "ignore PM when a 24 hour is present", ->
						t := DateTime.parse("15 PM", "%H %p")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 15:00:00\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 15
						assert! t.minute == 0
						assert! t.second == 0
					end
				end
			end

			context "minute", ->
				context "zero padded", ->
					should "parse repeated minutes", ->
						t := DateTime.parse("15 25 9 12", "%H %M %S %M")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 15:12:09\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 15
						assert! t.minute == 12
						assert! t.second == 9
					end

					should "parse two digits", ->
						t := DateTime.parse("15", "%M")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 00:15:00\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 0
						assert! t.minute == 15
						assert! t.second == 0
					end

					should "parse one digit", ->
						t := DateTime.parse("7", "%M")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 00:07:00\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 0
						assert! t.minute == 7
						assert! t.second == 0
					end

					should "parse with leading zero", ->
						t := DateTime.parse("07", "%M")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 00:07:00\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 0
						assert! t.minute == 7
						assert! t.second == 0
					end

					should "raise format error for leading space", ->
						assert_throws! DateTime.parse(" 7", "%M") match FormatError(message: 'time format string `"%M"` is incompatible with parsed input `" 7"`')
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%M") match FormatError(message: 'time format string `"%M"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%M") match FormatError(message: 'time format string `"%M"` is incompatible with parsed input `"foo"`')
					end

					should "raise format error for out of bounds", ->
						assert_throws! DateTime.parse("61", "%M") match FormatError(message: 'value for minute out of range: 61')
					end
				end

				context "no padding", ->
					should "parse two digits", ->
						t := DateTime.parse("15", "%-M")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 00:15:00\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 0
						assert! t.minute == 15
						assert! t.second == 0
					end

					should "parse one digit", ->
						t := DateTime.parse("7", "%-M")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 00:07:00\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 0
						assert! t.minute == 7
						assert! t.second == 0
					end

					should "parse with leading zero", ->
						t := DateTime.parse("07", "%-M")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 00:07:00\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 0
						assert! t.minute == 7
						assert! t.second == 0
					end

					should "raise format error for leading space", ->
						assert_throws! DateTime.parse(" 7", "%-M") match FormatError(message: 'time format string `"%-M"` is incompatible with parsed input `" 7"`')
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%-M") match FormatError(message: 'time format string `"%-M"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%-M") match FormatError(message: 'time format string `"%-M"` is incompatible with parsed input `"foo"`')
					end

					should "raise format error for out of bounds", ->
						assert_throws! DateTime.parse("78", "%-M") match FormatError(message: 'value for minute out of range: 78')
					end
				end

				context "space padded", ->
					should "parse two digits", ->
						t := DateTime.parse("15", "%_M")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 00:15:00\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 0
						assert! t.minute == 15
						assert! t.second == 0
					end

					should "parse one digit", ->
						t := DateTime.parse("7", "%_M")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 00:07:00\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 0
						assert! t.minute == 7
						assert! t.second == 0
					end

					should "parse with leading zero", ->
						t := DateTime.parse("07", "%_M")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 00:07:00\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 0
						assert! t.minute == 7
						assert! t.second == 0
					end

					should "parse with leading space", ->
						t := DateTime.parse(" 7", "%_M")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 00:07:00\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 0
						assert! t.minute == 7
						assert! t.second == 0
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%_M") match FormatError(message: 'time format string `"%_M"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%_M") match FormatError(message: 'time format string `"%_M"` is incompatible with parsed input `"foo"`')
					end

					should "raise format error for out of bounds", ->
						assert_throws! DateTime.parse("92", "%_M") match FormatError(message: 'value for minute out of range: 92')
					end
				end
			end

			context "second", ->
				context "zero padded", ->
					should "parse repeated seconds", ->
						t := DateTime.parse("15 25 9 12", "%H %M %S %S")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 15:25:12\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 15
						assert! t.minute == 25
						assert! t.second == 12
					end

					should "parse all digits", ->
						t := DateTime.parse("52", "%S")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 00:00:52\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 52
					end

					should "parse one digit", ->
						t := DateTime.parse("7", "%S")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 00:00:07\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 7
					end

					should "parse with leading zero", ->
						t := DateTime.parse("07", "%S")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 00:00:07\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 7
					end

					should "raise format error for leading space", ->
						assert_throws! DateTime.parse(" 7", "%S") match FormatError(message: 'time format string `"%S"` is incompatible with parsed input `" 7"`')
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%S") match FormatError(message: 'time format string `"%S"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%S") match FormatError(message: 'time format string `"%S"` is incompatible with parsed input `"foo"`')
					end

					should "raise format error for out of bounds", ->
						assert_throws! DateTime.parse("61", "%S") match FormatError(message: 'value for second out of range: 61')
					end
				end

				context "no padding", ->
					should "parse all digits", ->
						t := DateTime.parse("56", "%-S")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 00:00:56\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 56
					end

					should "parse one digit", ->
						t := DateTime.parse("7", "%-S")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 00:00:07\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 7
					end

					should "parse with leading zero", ->
						t := DateTime.parse("07", "%-S")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 00:00:07\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 7
					end

					should "raise format error for leading space", ->
						assert_throws! DateTime.parse(" 7", "%-S") match FormatError(message: 'time format string `"%-S"` is incompatible with parsed input `" 7"`')
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%-S") match FormatError(message: 'time format string `"%-S"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%-S") match FormatError(message: 'time format string `"%-S"` is incompatible with parsed input `"foo"`')
					end

					should "raise format error for out of bounds", ->
						assert_throws! DateTime.parse("78", "%-S") match FormatError(message: 'value for second out of range: 78')
					end
				end

				context "space padded", ->
					should "parse all digits", ->
						t := DateTime.parse("52", "%_S")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 00:00:52\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 52
					end

					should "parse one digit", ->
						t := DateTime.parse("7", "%_S")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 00:00:07\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 7
					end

					should "parse with leading zero", ->
						t := DateTime.parse("07", "%_S")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 00:00:07\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 7
					end

					should "parse with leading space", ->
						t := DateTime.parse(" 7", "%_S")
						assert! t <<: DateTime
						assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 00:00:07\.000000000 (\+|\-)\d{2}:\d{2}$/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 7
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%_S") match FormatError(message: 'time format string `"%_S"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%_S") match FormatError(message: 'time format string `"%_S"` is incompatible with parsed input `"foo"`')
					end

					should "raise format error for out of bounds", ->
						assert_throws! DateTime.parse("92", "%_S") match FormatError(message: 'value for second out of range: 92')
					end
				end
			end

			context "millisecond", ->
				context "zero padded", ->
					should "parse repeated milliseconds", ->
						t := DateTime.parse("120 15 25 9 552", "%L %H %M %S %L")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 15:25:09\.552000000 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 15
						assert! t.minute == 25
						assert! t.second == 9
						assert! t.millisecond == 552
					end

					should "parse all digits", ->
						t := DateTime.parse("152", "%L")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.152000000 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 152
					end

					should "parse one digit", ->
						t := DateTime.parse("5", "%L")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.005000000 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 5
					end

					should "parse with leading zero", ->
						t := DateTime.parse("075", "%L")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.075000000 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 75
					end

					should "raise format error for leading space", ->
						assert_throws! DateTime.parse(" 7", "%L") match FormatError(message: 'time format string `"%L"` is incompatible with parsed input `" 7"`')
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%L") match FormatError(message: 'time format string `"%L"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%L") match FormatError(message: 'time format string `"%L"` is incompatible with parsed input `"foo"`')
					end

					should "raise format error for out of bounds", ->
						assert_throws! DateTime.parse("1520", "%L") match FormatError(message: 'datetime format string `"%L"` is incompatible with parsed input `"1520"`')
					end
				end

				context "no padding", ->
					should "parse all digits", ->
						t := DateTime.parse("560", "%-L")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.560000000 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 560
					end

					should "parse one digit", ->
						t := DateTime.parse("7", "%-L")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.007000000 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 7
					end

					should "parse with leading zero", ->
						t := DateTime.parse("07", "%-L")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.007000000 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 7
					end

					should "raise format error for leading space", ->
						assert_throws! DateTime.parse(" 7", "%-L") match FormatError(message: 'time format string `"%-L"` is incompatible with parsed input `" 7"`')
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%-L") match FormatError(message: 'time format string `"%-L"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%-L") match FormatError(message: 'time format string `"%-L"` is incompatible with parsed input `"foo"`')
					end

					should "raise format error for out of bounds", ->
						assert_throws! DateTime.parse("7800", "%-L") match FormatError(message: "datetime format string `\"%-L\"` is incompatible with parsed input `\"7800\"`")
					end
				end

				context "space padded", ->
					should "parse all digits", ->
						t := DateTime.parse("520", "%_L")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.520000000 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 520
					end

					should "parse one digit", ->
						t := DateTime.parse("7", "%_L")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.007000000 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 7
					end

					should "parse with leading zero", ->
						t := DateTime.parse("07", "%_L")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.007000000 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 7
					end

					should "parse with leading space", ->
						t := DateTime.parse(" 7", "%_L")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.007000000 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 7
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%_L") match FormatError(message: 'time format string `"%_L"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%_L") match FormatError(message: 'time format string `"%_L"` is incompatible with parsed input `"foo"`')
					end

					should "raise format error for out of bounds", ->
						assert_throws! DateTime.parse("9200", "%_L") match FormatError(message: "datetime format string `\"%_L\"` is incompatible with parsed input `\"9200\"`")
					end
				end
			end

			context "microsecond", ->
				context "zero padded", ->
					should "parse repeated microseconds", ->
						t := DateTime.parse("152420 15 25 9 552992", "%6N %H %M %S %6N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 15:25:09\.552992000 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 15
						assert! t.minute == 25
						assert! t.second == 9
						assert! t.millisecond == 552
						assert! t.microsecond == 992
					end

					should "parse all digits", ->
						t := DateTime.parse("152420", "%6N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.152420000 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 152
						assert! t.microsecond == 420
					end

					should "parse one digit", ->
						t := DateTime.parse("7", "%6N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.000007000 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 0
						assert! t.microsecond == 7
					end

					should "parse with leading zeros", ->
						t := DateTime.parse("000075", "%6N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.000075000 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 0
						assert! t.microsecond == 75
					end

					should "raise format error for leading space", ->
						assert_throws! DateTime.parse(" 7", "%6N") match FormatError(message: 'time format string `"%6N"` is incompatible with parsed input `" 7"`')
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%6N") match FormatError(message: 'time format string `"%6N"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%6N") match FormatError(message: 'time format string `"%6N"` is incompatible with parsed input `"foo"`')
					end

					should "raise format error for out of bounds", ->
						assert_throws! DateTime.parse("1520000", "%6N") match FormatError(message: 'datetime format string `"%6N"` is incompatible with parsed input `"1520000"`')
					end
				end

				context "no padding", ->
					should "parse all digits", ->
						t := DateTime.parse("152420", "%-6N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.152420000 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 152
						assert! t.microsecond == 420
					end

					should "parse one digit", ->
						t := DateTime.parse("7", "%-6N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.000007000 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 0
						assert! t.microsecond == 7
					end

					should "parse with leading zero", ->
						t := DateTime.parse("07", "%-6N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.000007000 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 0
						assert! t.microsecond == 7
					end

					should "raise format error for leading space", ->
						assert_throws! DateTime.parse(" 7", "%-6N") match FormatError(message: 'time format string `"%-6N"` is incompatible with parsed input `" 7"`')
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%-6N") match FormatError(message: 'time format string `"%-6N"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%-6N") match FormatError(message: 'time format string `"%-6N"` is incompatible with parsed input `"foo"`')
					end

					should "raise format error for out of bounds", ->
						assert_throws! DateTime.parse("1520000", "%-6N") match FormatError(message: "datetime format string `\"%-6N\"` is incompatible with parsed input `\"1520000\"`")
					end
				end

				context "space padded", ->
					should "parse all digits", ->
						t := DateTime.parse("152420", "%_6N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.152420000 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 152
						assert! t.microsecond == 420
					end

					should "parse one digit", ->
						t := DateTime.parse("7", "%_6N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.000007000 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 0
						assert! t.microsecond == 7
					end

					should "parse with leading zero", ->
						t := DateTime.parse("07", "%_6N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.000007000 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 0
						assert! t.microsecond == 7
					end

					should "parse with leading space", ->
						t := DateTime.parse(" 7", "%_6N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.000007000 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 0
						assert! t.microsecond == 7
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%_6N") match FormatError(message: 'time format string `"%_6N"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%_6N") match FormatError(message: 'time format string `"%_6N"` is incompatible with parsed input `"foo"`')
					end

					should "raise format error for out of bounds", ->
						assert_throws! DateTime.parse("1520000", "%_6N") match FormatError(message: "datetime format string `\"%_6N\"` is incompatible with parsed input `\"1520000\"`")
					end
				end
			end

			context "nanosecond", ->
				context "zero padded", ->
					should "parse repeated nanoseconds", ->
						t := DateTime.parse("944152420 15 25 9 552992164", "%N %H %M %S %N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 15:25:09\.552992164 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 15
						assert! t.minute == 25
						assert! t.second == 9
						assert! t.millisecond == 552
						assert! t.microsecond == 992
						assert! t.nanosecond == 164
					end

					should "parse all digits", ->
						t := DateTime.parse("944152420", "%N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.944152420 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 944
						assert! t.microsecond == 152
						assert! t.nanosecond == 420
					end

					should "parse with 9N format", ->
						t := DateTime.parse("944152420", "%9N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.944152420 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 944
						assert! t.microsecond == 152
						assert! t.nanosecond == 420
					end

					should "parse one digit", ->
						t := DateTime.parse("7", "%N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.000000007 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 0
						assert! t.microsecond == 0
						assert! t.nanosecond == 7
					end

					should "parse with leading zeros", ->
						t := DateTime.parse("000000075", "%N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.000000075 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 0
						assert! t.microsecond == 0
						assert! t.nanosecond == 75
					end

					should "raise format error for leading space", ->
						assert_throws! DateTime.parse(" 7", "%N") match FormatError(message: 'time format string `"%N"` is incompatible with parsed input `" 7"`')
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%N") match FormatError(message: 'time format string `"%N"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%N") match FormatError(message: 'time format string `"%N"` is incompatible with parsed input `"foo"`')
					end

					should "raise format error for out of bounds", ->
						assert_throws! DateTime.parse("1520000000", "%N") match FormatError(message: 'datetime format string `"%N"` is incompatible with parsed input `"1520000000"`')
					end
				end

				context "no padding", ->
					should "parse all digits", ->
						t := DateTime.parse("944152420", "%-N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.944152420 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 944
						assert! t.microsecond == 152
						assert! t.nanosecond == 420
					end

					should "parse with -9N format", ->
						t := DateTime.parse("944152420", "%-9N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.944152420 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 944
						assert! t.microsecond == 152
						assert! t.nanosecond == 420
					end

					should "parse one digit", ->
						t := DateTime.parse("7", "%-N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.000000007 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 0
						assert! t.microsecond == 0
						assert! t.nanosecond == 7
					end

					should "parse with leading zero", ->
						t := DateTime.parse("000000075", "%-N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.000000075 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 0
						assert! t.microsecond == 0
						assert! t.nanosecond == 75
					end

					should "raise format error for leading space", ->
						assert_throws! DateTime.parse(" 7", "%-N") match FormatError(message: 'time format string `"%-N"` is incompatible with parsed input `" 7"`')
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%-N") match FormatError(message: 'time format string `"%-N"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%-N") match FormatError(message: 'time format string `"%-N"` is incompatible with parsed input `"foo"`')
					end

					should "raise format error for out of bounds", ->
						assert_throws! DateTime.parse("1520000000", "%-N") match FormatError(message: "datetime format string `\"%-N\"` is incompatible with parsed input `\"1520000000\"`")
					end
				end

				context "space padded", ->
					should "parse all digits", ->
						t := DateTime.parse("944152420", "%_N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.944152420 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 944
						assert! t.microsecond == 152
						assert! t.nanosecond == 420
					end

					should "parse with _9N format", ->
						t := DateTime.parse("944152420", "%_9N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.944152420 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 944
						assert! t.microsecond == 152
						assert! t.nanosecond == 420
					end

					should "parse one digit", ->
						t := DateTime.parse("7", "%_N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.000000007 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 0
						assert! t.microsecond == 0
						assert! t.nanosecond == 7
					end

					should "parse with leading zero", ->
						t := DateTime.parse("000000075", "%_N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.000000075 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 0
						assert! t.microsecond == 0
						assert! t.nanosecond == 75
					end

					should "parse with leading space", ->
						t := DateTime.parse("    7", "%_N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.000000007 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 0
						assert! t.microsecond == 0
						assert! t.nanosecond == 7
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%_N") match FormatError(message: 'time format string `"%_N"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%_N") match FormatError(message: 'time format string `"%_N"` is incompatible with parsed input `"foo"`')
					end

					should "raise format error for out of bounds", ->
						assert_throws! DateTime.parse("1520000000", "%_N") match FormatError(message: "datetime format string `\"%_N\"` is incompatible with parsed input `\"1520000000\"`")
					end
				end
			end

			context "picosecond", ->
				context "zero padded", ->
					should "parse repeated picoseconds", ->
						t := DateTime.parse("944152420212 15 25 9 552992164888", "%12N %H %M %S %12N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 15:25:09\.552992164 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 15
						assert! t.minute == 25
						assert! t.second == 9
						assert! t.millisecond == 552
						assert! t.microsecond == 992
						assert! t.nanosecond == 164
					end

					should "parse all digits", ->
						t := DateTime.parse("944152420212", "%12N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.944152420 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 944
						assert! t.microsecond == 152
						assert! t.nanosecond == 420
					end

					should "parse one digit", ->
						t := DateTime.parse("7", "%12N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 0
						assert! t.microsecond == 0
						assert! t.nanosecond == 0
					end

					should "parse with leading zeros", ->
						t := DateTime.parse("000152420212", "%12N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.000152420 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 0
						assert! t.microsecond == 152
						assert! t.nanosecond == 420
					end

					should "raise format error for leading space", ->
						assert_throws! DateTime.parse(" 7", "%12N") match FormatError(message: 'time format string `"%12N"` is incompatible with parsed input `" 7"`')
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%12N") match FormatError(message: 'time format string `"%12N"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%12N") match FormatError(message: 'time format string `"%12N"` is incompatible with parsed input `"foo"`')
					end

					should "raise format error for out of bounds", ->
						assert_throws! DateTime.parse("1520000000000", "%12N") match FormatError(message: 'datetime format string `"%12N"` is incompatible with parsed input `"1520000000000"`')
					end
				end

				context "no padding", ->
					should "parse all digits", ->
						t := DateTime.parse("944152420212", "%-12N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.944152420 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 944
						assert! t.microsecond == 152
						assert! t.nanosecond == 420
					end

					should "parse one digit", ->
						t := DateTime.parse("7", "%-12N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 0
						assert! t.microsecond == 0
						assert! t.nanosecond == 0
					end

					should "parse with leading zero", ->
						t := DateTime.parse("000152420212", "%-12N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.000152420 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 0
						assert! t.microsecond == 152
						assert! t.nanosecond == 420
					end

					should "raise format error for leading space", ->
						assert_throws! DateTime.parse(" 7", "%-12N") match FormatError(message: 'time format string `"%-12N"` is incompatible with parsed input `" 7"`')
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%-12N") match FormatError(message: 'time format string `"%-12N"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%-12N") match FormatError(message: 'time format string `"%-12N"` is incompatible with parsed input `"foo"`')
					end

					should "raise format error for out of bounds", ->
						assert_throws! DateTime.parse("1520000000000", "%-12N") match FormatError(message: "datetime format string `\"%-12N\"` is incompatible with parsed input `\"1520000000000\"`")
					end
				end

				context "space padded", ->
					should "parse all digits", ->
						t := DateTime.parse("944152420212", "%_12N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.944152420 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 944
						assert! t.microsecond == 152
						assert! t.nanosecond == 420
					end

					should "parse one digit", ->
						t := DateTime.parse("7", "%_12N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 0
						assert! t.microsecond == 0
						assert! t.nanosecond == 0
					end

					should "parse with leading zero", ->
						t := DateTime.parse("000152420212", "%_12N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.000152420 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 0
						assert! t.microsecond == 152
						assert! t.nanosecond == 420
					end

					should "parse with leading space", ->
						t := DateTime.parse("   152420212", "%_12N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.000152420 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 0
						assert! t.microsecond == 152
						assert! t.nanosecond == 420
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%_12N") match FormatError(message: 'time format string `"%_12N"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%_12N") match FormatError(message: 'time format string `"%_12N"` is incompatible with parsed input `"foo"`')
					end

					should "raise format error for out of bounds", ->
						assert_throws! DateTime.parse("1520000000000", "%_12N") match FormatError(message: "datetime format string `\"%_12N\"` is incompatible with parsed input `\"1520000000000\"`")
					end
				end
			end

			context "femtosecond", ->
				context "zero padded", ->
					should "parse repeated femtoseconds", ->
						t := DateTime.parse("944152420212794 15 25 9 552992164888376", "%15N %H %M %S %15N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 15:25:09\.552992164 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 15
						assert! t.minute == 25
						assert! t.second == 9
						assert! t.millisecond == 552
						assert! t.microsecond == 992
						assert! t.nanosecond == 164
					end

					should "parse all digits", ->
						t := DateTime.parse("944152420212794", "%15N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.944152420 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 944
						assert! t.microsecond == 152
						assert! t.nanosecond == 420
					end

					should "parse one digit", ->
						t := DateTime.parse("7", "%15N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 0
						assert! t.microsecond == 0
						assert! t.nanosecond == 0
					end

					should "parse with leading zeros", ->
						t := DateTime.parse("000152420212794", "%15N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.000152420 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 0
						assert! t.microsecond == 152
						assert! t.nanosecond == 420
					end

					should "raise format error for leading space", ->
						assert_throws! DateTime.parse(" 7", "%15N") match FormatError(message: 'time format string `"%15N"` is incompatible with parsed input `" 7"`')
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%15N") match FormatError(message: 'time format string `"%15N"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%15N") match FormatError(message: 'time format string `"%15N"` is incompatible with parsed input `"foo"`')
					end

					should "raise format error for out of bounds", ->
						assert_throws! DateTime.parse("1520000000000000", "%15N") match FormatError(message: 'datetime format string `"%15N"` is incompatible with parsed input `"1520000000000000"`')
					end
				end

				context "no padding", ->
					should "parse all digits", ->
						t := DateTime.parse("944152420212794", "%-15N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.944152420 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 944
						assert! t.microsecond == 152
						assert! t.nanosecond == 420
					end

					should "parse one digit", ->
						t := DateTime.parse("7", "%-15N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 0
						assert! t.microsecond == 0
						assert! t.nanosecond == 0
					end

					should "parse with leading zero", ->
						t := DateTime.parse("000152420212794", "%-15N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.000152420 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 0
						assert! t.microsecond == 152
						assert! t.nanosecond == 420
					end

					should "raise format error for leading space", ->
						assert_throws! DateTime.parse(" 7", "%-15N") match FormatError(message: 'time format string `"%-15N"` is incompatible with parsed input `" 7"`')
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%-15N") match FormatError(message: 'time format string `"%-15N"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%-15N") match FormatError(message: 'time format string `"%-15N"` is incompatible with parsed input `"foo"`')
					end

					should "raise format error for out of bounds", ->
						assert_throws! DateTime.parse("1520000000000000", "%-15N") match FormatError(message: "datetime format string `\"%-15N\"` is incompatible with parsed input `\"1520000000000000\"`")
					end
				end

				context "space padded", ->
					should "parse all digits", ->
						t := DateTime.parse("944152420212794", "%_15N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.944152420 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 944
						assert! t.microsecond == 152
						assert! t.nanosecond == 420
					end

					should "parse one digit", ->
						t := DateTime.parse("7", "%_15N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 0
						assert! t.microsecond == 0
						assert! t.nanosecond == 0
					end

					should "parse with leading zero", ->
						t := DateTime.parse("000152420212794", "%_15N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.000152420 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 0
						assert! t.microsecond == 152
						assert! t.nanosecond == 420
					end

					should "parse with leading space", ->
						t := DateTime.parse("   152420212794", "%_15N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.000152420 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 0
						assert! t.microsecond == 152
						assert! t.nanosecond == 420
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%_15N") match FormatError(message: 'time format string `"%_15N"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%_15N") match FormatError(message: 'time format string `"%_15N"` is incompatible with parsed input `"foo"`')
					end

					should "raise format error for out of bounds", ->
						assert_throws! DateTime.parse("1520000000000000", "%_15N") match FormatError(message: "datetime format string `\"%_15N\"` is incompatible with parsed input `\"1520000000000000\"`")
					end
				end
			end

			context "attosecond", ->
				context "zero padded", ->
					should "parse repeated attoseconds", ->
						t := DateTime.parse("944152420212794111 15 25 9 552992164888376909", "%18N %H %M %S %18N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 15:25:09\.552992164 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 15
						assert! t.minute == 25
						assert! t.second == 9
						assert! t.millisecond == 552
						assert! t.microsecond == 992
						assert! t.nanosecond == 164
					end

					should "parse all digits", ->
						t := DateTime.parse("944152420212794111", "%18N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.944152420 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 944
						assert! t.microsecond == 152
						assert! t.nanosecond == 420
					end

					should "parse one digit", ->
						t := DateTime.parse("7", "%18N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 0
						assert! t.microsecond == 0
						assert! t.nanosecond == 0
					end

					should "parse with leading zeros", ->
						t := DateTime.parse("000152420212794111", "%18N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.000152420 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 0
						assert! t.microsecond == 152
						assert! t.nanosecond == 420
					end

					should "raise format error for leading space", ->
						assert_throws! DateTime.parse(" 7", "%18N") match FormatError(message: 'time format string `"%18N"` is incompatible with parsed input `" 7"`')
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%18N") match FormatError(message: 'time format string `"%18N"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%18N") match FormatError(message: 'time format string `"%18N"` is incompatible with parsed input `"foo"`')
					end

					should "raise format error for out of bounds", ->
						assert_throws! DateTime.parse("1520000000000000000", "%18N") match FormatError(message: 'datetime format string `"%18N"` is incompatible with parsed input `"1520000000000000000"`')
					end
				end

				context "no padding", ->
					should "parse all digits", ->
						t := DateTime.parse("944152420212794111", "%-18N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.944152420 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 944
						assert! t.microsecond == 152
						assert! t.nanosecond == 420
					end

					should "parse one digit", ->
						t := DateTime.parse("7", "%-18N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 0
						assert! t.microsecond == 0
						assert! t.nanosecond == 0
					end

					should "parse with leading zero", ->
						t := DateTime.parse("000152420212794111", "%-18N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.000152420 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 0
						assert! t.microsecond == 152
						assert! t.nanosecond == 420
					end

					should "raise format error for leading space", ->
						assert_throws! DateTime.parse(" 7", "%-18N") match FormatError(message: 'time format string `"%-18N"` is incompatible with parsed input `" 7"`')
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%-18N") match FormatError(message: 'time format string `"%-18N"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%-18N") match FormatError(message: 'time format string `"%-18N"` is incompatible with parsed input `"foo"`')
					end

					should "raise format error for out of bounds", ->
						assert_throws! DateTime.parse("1520000000000000000", "%-18N") match FormatError(message: "datetime format string `\"%-18N\"` is incompatible with parsed input `\"1520000000000000000\"`")
					end
				end

				context "space padded", ->
					should "parse all digits", ->
						t := DateTime.parse("944152420212794111", "%_18N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.944152420 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 944
						assert! t.microsecond == 152
						assert! t.nanosecond == 420
					end

					should "parse one digit", ->
						t := DateTime.parse("7", "%_18N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 0
						assert! t.microsecond == 0
						assert! t.nanosecond == 0
					end

					should "parse with leading zero", ->
						t := DateTime.parse("000152420212794111", "%_18N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.000152420 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 0
						assert! t.microsecond == 152
						assert! t.nanosecond == 420
					end

					should "parse with leading space", ->
						t := DateTime.parse("   152420212794111", "%_18N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.000152420 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 0
						assert! t.microsecond == 152
						assert! t.nanosecond == 420
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%_18N") match FormatError(message: 'time format string `"%_18N"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%_18N") match FormatError(message: 'time format string `"%_18N"` is incompatible with parsed input `"foo"`')
					end

					should "raise format error for out of bounds", ->
						assert_throws! DateTime.parse("1520000000000000000", "%_18N") match FormatError(message: "datetime format string `\"%_18N\"` is incompatible with parsed input `\"1520000000000000000\"`")
					end
				end
			end

			context "zeptosecond", ->
				context "zero padded", ->
					should "parse repeated zeptoseconds", ->
						t := DateTime.parse("944152420212794111327 15 25 9 552992164888376909773", "%21N %H %M %S %21N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 15:25:09\.552992164 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 15
						assert! t.minute == 25
						assert! t.second == 9
						assert! t.millisecond == 552
						assert! t.microsecond == 992
						assert! t.nanosecond == 164
					end

					should "parse all digits", ->
						t := DateTime.parse("944152420212794111327", "%21N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.944152420 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 944
						assert! t.microsecond == 152
						assert! t.nanosecond == 420
					end

					should "parse one digit", ->
						t := DateTime.parse("7", "%21N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 0
						assert! t.microsecond == 0
						assert! t.nanosecond == 0
					end

					should "parse with leading zeros", ->
						t := DateTime.parse("000152420212794111327", "%21N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.000152420 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 0
						assert! t.microsecond == 152
						assert! t.nanosecond == 420
					end

					should "raise format error for leading space", ->
						assert_throws! DateTime.parse(" 7", "%21N") match FormatError(message: 'time format string `"%21N"` is incompatible with parsed input `" 7"`')
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%21N") match FormatError(message: 'time format string `"%21N"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%21N") match FormatError(message: 'time format string `"%21N"` is incompatible with parsed input `"foo"`')
					end

					should "raise format error for out of bounds", ->
						assert_throws! DateTime.parse("1520000000000000000000", "%21N") match FormatError(message: 'datetime format string `"%21N"` is incompatible with parsed input `"1520000000000000000000"`')
					end
				end

				context "no padding", ->
					should "parse two digits", ->
						t := DateTime.parse("944152420212794111327", "%-21N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.944152420 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 944
						assert! t.microsecond == 152
						assert! t.nanosecond == 420
					end

					should "parse one digit", ->
						t := DateTime.parse("7", "%-21N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 0
						assert! t.microsecond == 0
						assert! t.nanosecond == 0
					end

					should "parse with leading zero", ->
						t := DateTime.parse("000152420212794111327", "%-21N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.000152420 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 0
						assert! t.microsecond == 152
						assert! t.nanosecond == 420
					end

					should "raise format error for leading space", ->
						assert_throws! DateTime.parse(" 7", "%-21N") match FormatError(message: 'time format string `"%-21N"` is incompatible with parsed input `" 7"`')
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%-21N") match FormatError(message: 'time format string `"%-21N"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%-21N") match FormatError(message: 'time format string `"%-21N"` is incompatible with parsed input `"foo"`')
					end

					should "raise format error for out of bounds", ->
						assert_throws! DateTime.parse("1520000000000000000000", "%-21N") match FormatError(message: "datetime format string `\"%-21N\"` is incompatible with parsed input `\"1520000000000000000000\"`")
					end
				end

				context "space padded", ->
					should "parse two digits", ->
						t := DateTime.parse("944152420212794111327", "%_21N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.944152420 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 944
						assert! t.microsecond == 152
						assert! t.nanosecond == 420
					end

					should "parse one digit", ->
						t := DateTime.parse("7", "%_21N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.000000000 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 0
						assert! t.microsecond == 0
						assert! t.nanosecond == 0
					end

					should "parse with leading zero", ->
						t := DateTime.parse("000152420212794111327", "%_21N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.000152420 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 0
						assert! t.microsecond == 152
						assert! t.nanosecond == 420
					end

					should "parse with leading space", ->
						t := DateTime.parse("   152420212794111327", "%_21N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.000152420 (\+|\-)\d{2}:\d{2}/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 0
						assert! t.microsecond == 152
						assert! t.nanosecond == 420
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%_21N") match FormatError(message: 'time format string `"%_21N"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%_21N") match FormatError(message: 'time format string `"%_21N"` is incompatible with parsed input `"foo"`')
					end

					should "raise format error for out of bounds", ->
						assert_throws! DateTime.parse("1520000000000000000000", "%_21N") match FormatError(message: "datetime format string `\"%_21N\"` is incompatible with parsed input `\"1520000000000000000000\"`")
					end
				end
			end

			context "yoctosecond", ->
				context "zero padded", ->
					should "parse repeated yoctoseconds", ->
						t := DateTime.parse("944152420212794111327666 15 25 9 552992164888376909773445", "%24N %H %M %S %24N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 15:25:09\.552992164/
						assert! t.hour == 15
						assert! t.minute == 25
						assert! t.second == 9
						assert! t.millisecond == 552
						assert! t.microsecond == 992
						assert! t.nanosecond == 164
					end

					should "parse all digits", ->
						t := DateTime.parse("944152420212794111327666", "%24N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.944152420/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 944
						assert! t.microsecond == 152
						assert! t.nanosecond == 420
					end

					should "parse one digit", ->
						t := DateTime.parse("7", "%24N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.000000000/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 0
						assert! t.microsecond == 0
						assert! t.nanosecond == 0
					end

					should "parse with leading zeros", ->
						t := DateTime.parse("000152420212794111327666", "%24N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.000152420/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 0
						assert! t.microsecond == 152
						assert! t.nanosecond == 420
					end

					should "raise format error for leading space", ->
						assert_throws! DateTime.parse(" 7", "%24N") match FormatError(message: 'time format string `"%24N"` is incompatible with parsed input `" 7"`')
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%24N") match FormatError(message: 'time format string `"%24N"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%24N") match FormatError(message: 'time format string `"%24N"` is incompatible with parsed input `"foo"`')
					end

					should "raise format error for out of bounds", ->
						assert_throws! DateTime.parse("1520000000000000000000000", "%24N") match FormatError(message: 'datetime format string `"%24N"` is incompatible with parsed input `"1520000000000000000000000"`')
					end
				end

				context "no padding", ->
					should "parse all digits", ->
						t := DateTime.parse("944152420212794111327666", "%-24N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.944152420/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 944
						assert! t.microsecond == 152
						assert! t.nanosecond == 420
					end

					should "parse one digit", ->
						t := DateTime.parse("7", "%-24N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.000000000/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 0
						assert! t.microsecond == 0
						assert! t.nanosecond == 0
					end

					should "parse with leading zero", ->
						t := DateTime.parse("000152420212794111327666", "%-24N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.000152420/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 0
						assert! t.microsecond == 152
						assert! t.nanosecond == 420
					end

					should "raise format error for leading space", ->
						assert_throws! DateTime.parse(" 7", "%-24N") match FormatError(message: 'time format string `"%-24N"` is incompatible with parsed input `" 7"`')
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%-24N") match FormatError(message: 'time format string `"%-24N"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%-24N") match FormatError(message: 'time format string `"%-24N"` is incompatible with parsed input `"foo"`')
					end

					should "raise format error for out of bounds", ->
						assert_throws! DateTime.parse("1520000000000000000000000", "%-24N") match FormatError(message: "datetime format string `\"%-24N\"` is incompatible with parsed input `\"1520000000000000000000000\"`")
					end
				end

				context "space padded", ->
					should "parse two digits", ->
						t := DateTime.parse("944152420212794111327666", "%_24N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.944152420/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 944
						assert! t.microsecond == 152
						assert! t.nanosecond == 420
					end

					should "parse one digit", ->
						t := DateTime.parse("7", "%_24N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.000000000/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 0
						assert! t.microsecond == 0
						assert! t.nanosecond == 0
					end

					should "parse with leading zero", ->
						t := DateTime.parse("000152420212794111327666", "%_24N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.000152420/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 0
						assert! t.microsecond == 152
						assert! t.nanosecond == 420
					end

					should "parse with leading space", ->
						t := DateTime.parse("   152420212794111327666", "%_24N")
						assert! t <<: DateTime
						assert! t.to_string match %/\d{4}-\d{2}-\d{2} 00:00:00\.000152420/
						assert! t.hour == 0
						assert! t.minute == 0
						assert! t.second == 0
						assert! t.millisecond == 0
						assert! t.microsecond == 152
						assert! t.nanosecond == 420
					end

					should "raise format error for no digits", ->
						assert_throws! DateTime.parse("", "%_24N") match FormatError(message: 'time format string `"%_24N"` is incompatible with parsed input `""`')
					end

					should "raise format error for text", ->
						assert_throws! DateTime.parse("foo", "%_24N") match FormatError(message: 'time format string `"%_24N"` is incompatible with parsed input `"foo"`')
					end

					should "raise format error for out of bounds", ->
						assert_throws! DateTime.parse("1520000000000000000000000", "%_24N") match FormatError(message: "datetime format string `\"%_24N\"` is incompatible with parsed input `\"1520000000000000000000000\"`")
					end
				end
			end

			context "time12",  ->
				should "parse valid input", ->
					t := DateTime.parse("10:34:15 pm", "%r")
					assert! t <<: DateTime
					assert! t.to_string match %/\d{4}-\d{2}-\d{2} 22:34:15\.000000000 (\+|\-)\d{2}:\d{2}/
					assert! t.hour == 22
					assert! t.minute == 34
					assert! t.second == 15
				end

				should "throw a format error on wrong separator", ->
					assert_throws! DateTime.parse("10-34:15 pm", "%r") match FormatError(message: "cannot parse time string, expected `\":\"`, got `\"-\"`")
				end

				should "throw a format error on out of range minute", ->
					assert_throws! DateTime.parse("10:90:15 pm", "%r") match FormatError(message: "value for minute out of range: 90")
				end
			end

			context "time24",  ->
				should "parse valid input", ->
					t := DateTime.parse("15:34", "%R")
					assert! t <<: DateTime
					assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 15:34:00\.000000000 (\+|\-)\d{2}:\d{2}$/
					assert! t.hour == 15
					assert! t.minute == 34
					assert! t.second == 0
				end

				should "throw a format error on wrong separator", ->
					assert_throws! DateTime.parse("15-34", "%R") match FormatError(message: "cannot parse time string, expected `\":\"`, got `\"-\"`")
				end

				should "throw a format error on out of range minute", ->
					assert_throws! DateTime.parse("10:90", "%R") match FormatError(message: "value for minute out of range: 90")
				end
			end

			context "time24 with seconds",  ->
				should "parse valid input", ->
					t := DateTime.parse("15:34:15", "%T")
					assert! t <<: DateTime
					assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 15:34:15\.000000000 (\+|\-)\d{2}:\d{2}$/
					assert! t.hour == 15
					assert! t.minute == 34
					assert! t.second == 15
				end

				should "throw a format error on wrong separator", ->
					assert_throws! DateTime.parse("15-34:15", "%T") match FormatError(message: "cannot parse time string, expected `\":\"`, got `\"-\"`")
				end

				should "throw a format error on out of range minute", ->
					assert_throws! DateTime.parse("15:90:15", "%T") match FormatError(message: "value for minute out of range: 90")
				end
			end

			context "timezone offset",  ->
				should "parse UTC offset", ->
					t := DateTime.parse("+0000", "%z")
					assert! t <<: DateTime
					assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 00:00:00\.000000000 \+00:00$/
					assert! t.zone == Timezone.from_offset(0.hours)
					assert! t.zone.name == "UTC"
				end

				should "parse CET offset", ->
					t := DateTime.parse("+0100", "%z")
					assert! t <<: DateTime
					assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 00:00:00\.000000000 \+01:00$/
					assert! t.zone_offset == 1.hour
					assert! t.zone == Timezone.from_offset(1.hour)
					assert! t.zone.name == "UTC+01:00:00"
				end

				should "parse negative offset", ->
					t := DateTime.parse("-0845", "%z")
					assert! t <<: DateTime
					assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 00:00:00\.000000000 \-08:45$/
					assert! t.zone_offset == -8.hours - 45.minutes
					assert! t.zone == Timezone.from_offset(-8.hours - 45.minutes)
					assert! t.zone.name == "UTC-08:45:00"
				end

				should "throw a format error on wrong sign char", ->
					assert_throws! DateTime.parse(":0000", "%z") match FormatError(message: "invalid datetime timezone sign: :")
				end

				should "throw a format error on out of range", ->
					assert_throws! DateTime.parse("+123456", "%z") match FormatError(message: "datetime format string `\"%z\"` is incompatible with parsed input `\"+123456\"`")
				end
			end

			context "timezone offset colon",  ->
				should "parse UTC offset", ->
					t := DateTime.parse("+00:00", "%:z")
					assert! t <<: DateTime
					assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 00:00:00\.000000000 \+00:00$/
					assert! t.zone == Timezone.from_offset(0.hours)
					assert! t.zone.name == "UTC"
				end

				should "parse CET offset", ->
					t := DateTime.parse("+01:00", "%:z")
					assert! t <<: DateTime
					assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 00:00:00\.000000000 \+01:00$/
					assert! t.zone_offset == 1.hour
					assert! t.zone == Timezone.from_offset(1.hour)
					assert! t.zone.name == "UTC+01:00:00"
				end

				should "parse negative offset", ->
					t := DateTime.parse("-08:45", "%:z")
					assert! t <<: DateTime
					assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 00:00:00\.000000000 \-08:45$/
					assert! t.zone_offset == -8.hours - 45.minutes
					assert! t.zone == Timezone.from_offset(-8.hours - 45.minutes)
					assert! t.zone.name == "UTC-08:45:00"
				end

				should "throw a format error on wrong sign char", ->
					assert_throws! DateTime.parse(":00:00", "%:z") match FormatError(message: "invalid datetime timezone sign: :")
				end

				should "throw a format error on out of range", ->
					assert_throws! DateTime.parse("+12:34:56", "%:z") match FormatError(message: "datetime format string `\"%:z\"` is incompatible with parsed input `\"+12:34:56\"`")
				end
			end

			context "timezone name",  ->
				should "parse UTC", ->
					t := DateTime.parse("UTC", "%Z")
					assert! t <<: DateTime
					assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 00:00:00\.000000000 \+00:00$/
					assert! t.zone == Timezone.from_offset(0.hours)
					assert! t.zone.name == "UTC"
				end

				should "parse CET", ->
					t := DateTime.parse("CET", "%Z")
					assert! t <<: DateTime
					assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 00:00:00\.000000000 \+01:00$/
					assert! t.zone_offset == 1.hour
					assert! t.zone == Timezone.from_offset(1.hour)
					assert! t.zone.name == "UTC+01:00:00"
				end

				should "parse MIT", ->
					t := DateTime.parse("MIT", "%Z")
					assert! t <<: DateTime
					assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 00:00:00\.000000000 \-09:30$/
					assert! t.zone_offset == -9.hours - 30.minutes
					assert! t.zone == Timezone.from_offset(-9.hour - 30.minutes)
					assert! t.zone.name == "UTC-09:30:00"
				end

				should "throw a format error on ambiguous ACT", ->
					assert_throws! DateTime.parse("ACT", "%Z") match FormatError(message: "invalid datetime timezone abbreviation: ACT")
				end

				should "throw a format error on nonexistent zone name", ->
					assert_throws! DateTime.parse("FOO", "%Z") match FormatError(message: "invalid datetime timezone abbreviation: FOO")
				end
			end

			context "timezone IANA name",  ->
				should "parse UTC", ->
					t := DateTime.parse("UTC", '%#Z')
					assert! t <<: DateTime
					assert! t.to_string match %/^\d{4}-\d{2}-\d{2} 00:00:00\.000000000 \+00:00$/
					assert! t.zone == Timezone::UTC
				end

				should "parse american timezones", ->
					t := DateTime.parse("25-01-01 America/Indiana/Tell_City", '%y-%m-%d %#Z')
					assert! t <<: DateTime
					assert! t.to_string match %/^2025-01-01 00:00:00\.000000000 \-06:00$/
					assert! t.zone_offset == -6.hour
					assert! t.zone == Timezone['America/Indiana/Tell_City']
				end

				should "parse warsaw standard offset", ->
					t := DateTime.parse("25-01-01 Europe/Warsaw", '%y-%m-%d %#Z')
					assert! t <<: DateTime
					assert! t.to_string match %/^2025-01-01 00:00:00\.000000000 \+01:00$/
					assert! t.zone_offset == 1.hour
					assert! t.zone == Timezone['Europe/Warsaw']
				end

				should "parse warsaw dst offset", ->
					t := DateTime.parse("25-07-01 Europe/Warsaw", '%y-%m-%d %#Z')
					assert! t <<: DateTime
					assert! t.to_string match %/^2025-07-01 00:00:00\.000000000 \+02:00$/
					assert! t.zone_offset == 2.hour
					assert! t.zone == Timezone['Europe/Warsaw']
				end

				should "throw a format error on nonexistent zone name", ->
					assert_throws! DateTime.parse("Europe/Foobar", '%#Z') match FormatError(message: "invalid datetime timezone name: Europe/Foobar")
				end
			end

			context "date and time",  ->
				should "parse valid input", ->
					t := DateTime.parse("Tue Jan 25 15:53:22 2025", "%c")
					assert! t <<: DateTime
					assert! t.to_string match %/^2025-01-25 15:53:22\.000000000 (\+|\-)\d{2}:\d{2}$/
					assert! t.year == 2025
					assert! t.month == 1
					assert! t.day == 25
					assert! t.hour == 15
					assert! t.minute == 53
					assert! t.second == 22
					assert! t.zone == Timezone::LOCAL
				end

				should "parse uppercase", ->
					t := DateTime.parse("TUE JAN 25 15:53:22 2025", "%^c")
					assert! t <<: DateTime
					assert! t.to_string match %/^2025-01-25 15:53:22\.000000000 (\+|\-)\d{2}:\d{2}$/
					assert! t.year == 2025
					assert! t.month == 1
					assert! t.day == 25
					assert! t.hour == 15
					assert! t.minute == 53
					assert! t.second == 22
					assert! t.zone == Timezone::LOCAL
				end

				should "throw a format error on wrong separator", ->
					assert_throws! DateTime.parse("Tue Jan 25 15.53.22 2025", "%c") match FormatError(message: "cannot parse time string, expected `\":\"`, got `\".\"`")
				end

				should "throw a format error on out of range hour", ->
					assert_throws! DateTime.parse("Tue Jan 25 25:53:22 2025", "%c") match FormatError(message: "value for hour out of range: 25")
				end
			end

			context "date1",  ->
				should "parse valid input", ->
					t := DateTime.parse("Fri Feb  3 16:09:07 UTC 2023", "%+")
					assert! t <<: DateTime
					assert! t.to_string == "2023-02-03 16:09:07.000000000 +00:00"
					assert! t.year == 2023
					assert! t.month == 2
					assert! t.day == 3
					assert! t.hour == 16
					assert! t.minute == 9
					assert! t.second == 7
					assert! t.zone == Timezone.from_offset(0.hours)
				end

				should "parse uppercase", ->
					t := DateTime.parse("FRI FEB  3 16:09:07 CET 2023", "%^+")
					assert! t <<: DateTime
					assert! t.to_string == "2023-02-03 16:09:07.000000000 +01:00"
					assert! t.year == 2023
					assert! t.month == 2
					assert! t.day == 3
					assert! t.hour == 16
					assert! t.minute == 9
					assert! t.second == 7
					assert! t.zone == Timezone.from_offset(1.hours)
				end

				should "throw a format error on wrong separator", ->
					assert_throws! DateTime.parse("Fri Feb  3 16-09:07 UTC 2023", "%+") match FormatError(message: "cannot parse time string, expected `\":\"`, got `\"-\"`")
				end

				should "throw a format error on out of range hour", ->
					assert_throws! DateTime.parse("Tue Jan 25 25:53:22 UTC 2025", "%+") match FormatError(message: "value for hour out of range: 25")
				end
			end

		end

	end

	context "strftime", ->
		context "full iso year", ->
			should "build all digits", ->
				t := DateTime(2023, 1, 1)
				assert! t.strftime("%G") == "2022"
			end

			should "build one digit with zero padding", ->
				t := DateTime(8)
				assert! t.strftime("%G") == "0008"
			end

			should "build one digit without padding", ->
				t := DateTime(8)
				assert! t.strftime("%-G") == "8"
			end

			should "build one digit with space padding", ->
				t := DateTime(8)
				assert! t.strftime("%_G") == "   8"
			end
		end

		context "full year", ->
			should "build all digits", ->
				t := DateTime(2023, 1, 1)
				assert! t.strftime("%Y") == "2023"
			end

			should "build one digit with zero padding", ->
				t := DateTime(8)
				assert! t.strftime("%Y") == "0008"
			end

			should "build one digit without padding", ->
				t := DateTime(8)
				assert! t.strftime("%-Y") == "8"
			end

			should "build one digit with space padding", ->
				t := DateTime(8)
				assert! t.strftime("%_Y") == "   8"
			end
		end

		context "century", ->
			should "build all digits", ->
				t := DateTime(2023, 1, 1)
				assert! t.strftime("%C") == "20"
			end

			should "build one digit with zero padding", ->
				t := DateTime(800)
				assert! t.strftime("%C") == "08"
			end

			should "build one digit without padding", ->
				t := DateTime(800)
				assert! t.strftime("%-C") == "8"
			end

			should "build one digit with space padding", ->
				t := DateTime(800)
				assert! t.strftime("%_C") == " 8"
			end
		end

		context "iso year last two", ->
			should "build all digits", ->
				t := DateTime(2023, 1, 1)
				assert! t.strftime("%g") == "22"
			end

			should "build one digit with zero padding", ->
				t := DateTime(8)
				assert! t.strftime("%g") == "08"
			end

			should "build one digit without padding", ->
				t := DateTime(8)
				assert! t.strftime("%-g") == "8"
			end

			should "build one digit with space padding", ->
				t := DateTime(8)
				assert! t.strftime("%_g") == " 8"
			end
		end

		context "year last two", ->
			should "build one digit with zero padding", ->
				t := DateTime(2023, 1, 1)
				assert! t.strftime("%y") == "23"
			end

			should "build one digit with zero padding", ->
				t := DateTime(8)
				assert! t.strftime("%y") == "08"
			end

			should "build one digit without padding", ->
				t := DateTime(8)
				assert! t.strftime("%-y") == "8"
			end

			should "build one digit with space padding", ->
				t := DateTime(8)
				assert! t.strftime("%_y") == " 8"
			end
		end

		context "month", ->
			should "build all digits", ->
				t := DateTime(2023, 11, 1)
				assert! t.strftime("%m") == "11"
			end

			should "build one digit with zero padding", ->
				t := DateTime(2025, 8)
				assert! t.strftime("%m") == "08"
			end

			should "build one digit without padding", ->
				t := DateTime(2025, 8)
				assert! t.strftime("%-m") == "8"
			end

			should "build one digit with space padding", ->
				t := DateTime(2025, 8)
				assert! t.strftime("%_m") == " 8"
			end
		end

		context "month full name", ->
			should "build november", ->
				t := DateTime(2023, 11, 1)
				assert! t.strftime("%B") == "November"
			end

			should "build uppercase", ->
				t := DateTime(2023, 3, 1)
				assert! t.strftime("%^B") == "MARCH"
			end
		end

		context "month abbreviated name", ->
			should "build november", ->
				t := DateTime(2023, 11, 1)
				assert! t.strftime("%b") == "Nov"
			end

			should "build uppercase", ->
				t := DateTime(2023, 3, 1)
				assert! t.strftime("%^b") == "MAR"
			end
		end

		context "day", ->
			should "build all digits", ->
				t := DateTime(2023, 11, 15)
				assert! t.strftime("%d") == "15"
			end

			should "build one digit with zero padding", ->
				t := DateTime(2025, 10, 8)
				assert! t.strftime("%d") == "08"
			end

			should "build one digit without padding", ->
				t := DateTime(2025, 10, 8)
				assert! t.strftime("%-d") == "8"
			end

			should "build one digit with space padding", ->
				t := DateTime(2025, 10, 8)
				assert! t.strftime("%_d") == " 8"
			end
		end

		context "day of year", ->
			should "build all digits", ->
				t := DateTime(2023, 11, 15)
				assert! t.strftime("%j") == "319"
			end

			should "build one digit with zero padding", ->
				t := DateTime(2025, 1, 8)
				assert! t.strftime("%j") == "008"
			end

			should "build one digit without padding", ->
				t := DateTime(2025, 1, 8)
				assert! t.strftime("%-j") == "8"
			end

			should "build one digit with space padding", ->
				t := DateTime(2025, 1, 8)
				assert! t.strftime("%_j") == "  8"
			end
		end

		context "day of week full name", ->
			should "build monday", ->
				t := DateTime(2025, 11, 24)
				assert! t.strftime("%A") == "Monday"
			end

			should "build uppercase", ->
				t := DateTime(2025, 11, 27)
				assert! t.strftime("%^A") == "THURSDAY"
			end
		end

		context "day of week abbreviated name", ->
			should "build monday", ->
				t := DateTime(2025, 11, 24)
				assert! t.strftime("%a") == "Mon"
			end

			should "build uppercase", ->
				t := DateTime(2025, 11, 27)
				assert! t.strftime("%^a") == "THU"
			end
		end

		context "day of week number", ->
			should "build 7 for sunday", ->
				t := DateTime(2025, 11, 23)
				assert! t.strftime("%u") == "7"
			end

			should "build 4 for thursday", ->
				t := DateTime(2025, 11, 27)
				assert! t.strftime("%u") == "4"
			end
		end

		context "day of week number alt", ->
			should "build 0 for sunday", ->
				t := DateTime(2025, 11, 23)
				assert! t.strftime("%w") == "0"
			end

			should "build 4 for thursday", ->
				t := DateTime(2025, 11, 27)
				assert! t.strftime("%w") == "4"
			end
		end

		context "iso week", ->
			should "build for previous year", ->
				t := DateTime(2023, 1, 1)
				assert! t.strftime("%V %G") == "52 2022"
			end

			should "build all digits", ->
				t := DateTime(2023, 11, 15)
				assert! t.strftime("%V") == "46"
			end

			should "build one digit with zero padding", ->
				t := DateTime(2025, 1, 8)
				assert! t.strftime("%V") == "02"
			end

			should "build one digit without padding", ->
				t := DateTime(2025, 1, 8)
				assert! t.strftime("%-V") == "2"
			end

			should "build one digit with space padding", ->
				t := DateTime(2025, 1, 8)
				assert! t.strftime("%_V") == " 2"
			end
		end

		context "year week", ->
			should "always build for current year", ->
				t := DateTime(2023, 1, 1)
				assert! t.strftime("%W %Y") == "00 2023"
			end

			should "build all digits", ->
				t := DateTime(2023, 11, 15)
				assert! t.strftime("%W") == "46"
			end

			should "build one digit with zero padding", ->
				t := DateTime(2025, 1, 8)
				assert! t.strftime("%W") == "01"
			end

			should "build one digit without padding", ->
				t := DateTime(2025, 1, 8)
				assert! t.strftime("%-W") == "1"
			end

			should "build one digit with space padding", ->
				t := DateTime(2025, 1, 8)
				assert! t.strftime("%_W") == " 1"
			end
		end

		context "year week alt", ->
			should "always build for current year", ->
				t := DateTime(2023, 1, 1)
				assert! t.strftime("%U %Y") == "01 2023"
			end

			should "build all digits", ->
				t := DateTime(2023, 11, 15)
				assert! t.strftime("%U") == "46"
			end

			should "build one digit with zero padding", ->
				t := DateTime(2025, 1, 8)
				assert! t.strftime("%U") == "01"
			end

			should "build one digit without padding", ->
				t := DateTime(2025, 1, 8)
				assert! t.strftime("%-U") == "1"
			end

			should "build one digit with space padding", ->
				t := DateTime(2025, 1, 8)
				assert! t.strftime("%_U") == " 1"
			end
		end

		context "date", ->
			should "build", ->
				t := DateTime(2023, 2, 3)
				assert! t.strftime("%D") == "02/03/23"
			end
		end

		context "ISO8601 date", ->
			should "build", ->
				t := DateTime(2023, 2, 3)
				assert! t.strftime("%F") == "2023-02-03"
			end
		end

		context "hour", ->
			should "build one digit with zero padding", ->
				t := DateTime(hour: 8)
				assert! t.strftime("%H") == "08"
			end

			should "build one digit without padding", ->
				t := DateTime(hour: 8)
				assert! t.strftime("%-H") == "8"
			end

			should "build one digit with space padding", ->
				t := DateTime(hour: 8)
				assert! t.strftime("%_H") == " 8"
			end
		end

		context "hour 12", ->
			should "build AM", ->
				t := DateTime(hour: 8)
				assert! t.strftime("%I") == "08"
			end

			should "build PM", ->
				t := DateTime(hour: 16)
				assert! t.strftime("%I") == "04"
			end

			should "build one digit with zero padding", ->
				t := DateTime(hour: 18)
				assert! t.strftime("%I") == "06"
			end

			should "build one digit without padding", ->
				t := DateTime(hour: 8)
				assert! t.strftime("%-H") == "8"
			end

			should "build one digit with space padding", ->
				t := DateTime(hour: 8)
				assert! t.strftime("%_H") == " 8"
			end
		end

		context "meridiem", ->
			should "build one digit PM with zero padding", ->
				t := DateTime(hour: 16)
				assert! t.strftime("%I %P") == "04 pm"
			end

			should "build 12 PM", ->
				t := DateTime(hour: 12)
				assert! t.strftime("%I %P") == "12 pm"
			end

			should "build 12 AM", ->
				t := DateTime(hour: 0)
				assert! t.strftime("%I %P") == "12 am"
			end

			should "build lowercase 6 AM", ->
				t := DateTime(hour: 6)
				assert! t.strftime("%I %P") == "06 am"
			end

			should "build uppercase 6 AM", ->
				t := DateTime(hour: 6)
				assert! t.strftime("%I %^P") == "06 AM"
			end

			should "build one digit without padding", ->
				t := DateTime(hour: 8)
				assert! t.strftime("%-I") == "8"
			end

			should "build one digit with space padding", ->
				t := DateTime(hour: 8)
				assert! t.strftime("%_I") == " 8"
			end
		end

		context "minute", ->
			should "build two digits", ->
				t := DateTime(minute: 28)
				assert! t.strftime("%M") == "28"
			end

			should "build one digit with zero padding", ->
				t := DateTime(minute: 9)
				assert! t.strftime("%M") == "09"
			end

			should "build one digit without padding", ->
				t := DateTime(minute: 9)
				assert! t.strftime("%-M") == "9"
			end

			should "build one digit with space padding", ->
				t := DateTime(minute: 9)
				assert! t.strftime("%_M") == " 9"
			end
		end

		context "second", ->
			should "build two digits", ->
				t := DateTime(second: 28)
				assert! t.strftime("%S") == "28"
			end

			should "build one digit with zero padding", ->
				t := DateTime(second: 9)
				assert! t.strftime("%S") == "09"
			end

			should "build one digit without padding", ->
				t := DateTime(second: 9)
				assert! t.strftime("%-S") == "9"
			end

			should "build one digit with space padding", ->
				t := DateTime(second: 9)
				assert! t.strftime("%_S") == " 9"
			end
		end

		context "millisecond", ->
			should "build three digits", ->
				t := DateTime(millisecond: 282)
				assert! t.strftime("%L") == "282"
			end

			should "build one digit with zero padding", ->
				t := DateTime(millisecond: 9)
				assert! t.strftime("%L") == "009"
			end

			should "build one digit without padding", ->
				t := DateTime(millisecond: 9)
				assert! t.strftime("%-L") == "9"
			end

			should "build one digit with space padding", ->
				t := DateTime(millisecond: 9)
				assert! t.strftime("%_L") == "  9"
			end
		end

		context "microsecond", ->
			should "build all digits", ->
				t := DateTime(microsecond: 282_984)
				assert! t.strftime("%6N") == "282984"
			end

			should "build one digit with zero padding", ->
				t := DateTime(microsecond: 9)
				assert! t.strftime("%6N") == "000009"
			end

			should "build one digit without padding", ->
				t := DateTime(microsecond: 9)
				assert! t.strftime("%-6N") == "9"
			end

			should "build one digit with space padding", ->
				t := DateTime(microsecond: 9)
				assert! t.strftime("%_6N") == "     9"
			end
		end

		context "nanosecond", ->
			should "build all digits", ->
				t := DateTime(nanosecond: 282_984_777)
				assert! t.strftime("%9N") == "282984777"
			end

			should "build one digit with zero padding", ->
				t := DateTime(nanosecond: 9)
				assert! t.strftime("%9N") == "000000009"
			end

			should "build one digit without padding", ->
				t := DateTime(nanosecond: 9)
				assert! t.strftime("%-9N") == "9"
			end

			should "build one digit with space padding", ->
				t := DateTime(nanosecond: 9)
				assert! t.strftime("%_9N") == "        9"
			end
		end

		context "picosecond", ->
			should "build all digits", ->
				t := DateTime(nanosecond: 282_984_777)
				assert! t.strftime("%12N") == "282984777000"
			end

			should "build with zero padding", ->
				t := DateTime(nanosecond: 9)
				assert! t.strftime("%12N") == "000000009000"
			end

			should "build without padding", ->
				t := DateTime(nanosecond: 9)
				assert! t.strftime("%-12N") == "9000"
			end

			should "build with space padding", ->
				t := DateTime(nanosecond: 9)
				assert! t.strftime("%_12N") == "        9000"
			end
		end

		context "femtosecond", ->
			should "build all digits", ->
				t := DateTime(nanosecond: 282_984_777)
				assert! t.strftime("%15N") == "282984777000000"
			end

			should "build with zero padding", ->
				t := DateTime(nanosecond: 9)
				assert! t.strftime("%15N") == "000000009000000"
			end

			should "build without padding", ->
				t := DateTime(nanosecond: 9)
				assert! t.strftime("%-15N") == "9000000"
			end

			should "build with space padding", ->
				t := DateTime(nanosecond: 9)
				assert! t.strftime("%_15N") == "        9000000"
			end
		end

		context "attosecond", ->
			should "build all digits", ->
				t := DateTime(nanosecond: 282_984_777)
				assert! t.strftime("%18N") == "282984777000000000"
			end

			should "build with zero padding", ->
				t := DateTime(nanosecond: 9)
				assert! t.strftime("%18N") == "000000009000000000"
			end

			should "build without padding", ->
				t := DateTime(nanosecond: 9)
				assert! t.strftime("%-18N") == "9000000000"
			end

			should "build with space padding", ->
				t := DateTime(nanosecond: 9)
				assert! t.strftime("%_18N") == "        9000000000"
			end
		end

		context "zeptosecond", ->
			should "build all digits", ->
				t := DateTime(nanosecond: 282_984_777)
				assert! t.strftime("%21N") == "282984777000000000000"
			end

			should "build with zero padding", ->
				t := DateTime(nanosecond: 9)
				assert! t.strftime("%21N") == "000000009000000000000"
			end

			should "build without padding", ->
				t := DateTime(nanosecond: 9)
				assert! t.strftime("%-21N") == "9000000000000"
			end

			should "build with space padding", ->
				t := DateTime(nanosecond: 9)
				assert! t.strftime("%_21N") == "        9000000000000"
			end
		end

		context "yoctosecond", ->
			should "build all digits", ->
				t := DateTime(nanosecond: 282_984_777)
				assert! t.strftime("%24N") == "282984777000000000000000"
			end

			should "build with zero padding", ->
				t := DateTime(nanosecond: 9)
				assert! t.strftime("%24N") == "000000009000000000000000"
			end

			should "build without padding", ->
				t := DateTime(nanosecond: 9)
				assert! t.strftime("%-24N") == "9000000000000000"
			end

			should "build with space padding", ->
				t := DateTime(nanosecond: 9)
				assert! t.strftime("%_24N") == "        9000000000000000"
			end
		end

		context "date1", ->
			should "build", ->
				t := DateTime(2025, 10, 25, 14, 44, 13)
				assert! t.strftime("%+") == "Sat Oct 25 14:44:13 CEST 2025"
			end

			should "build uppercase", ->
				t := DateTime(2025, 10, 25, 14, 44, 13)
				assert! t.strftime("%^+") == "SAT OCT 25 14:44:13 CEST 2025"
			end
		end

		context "date and time", ->
			should "build", ->
				t := DateTime(2025, 10, 25, 14, 44, 13)
				assert! t.strftime("%c") == "Sat Oct 25 14:44:13 2025"
			end

			should "build uppercase", ->
				t := DateTime(2025, 10, 25, 14, 44, 13)
				assert! t.strftime("%^c") == "SAT OCT 25 14:44:13 2025"
			end
		end

		context "timezone name", ->
			should "build", ->
				t := DateTime(2025, 10, 25, 14, 44, 13, zone: Timezone['Europe/Warsaw'])
				assert! t.strftime("%Z") == "CEST"
			end
		end

		context "timezone IANA name", ->
			should "build", ->
				t := DateTime(2025, 10, 25, 14, 44, 13, zone: Timezone['Europe/Warsaw'])
				assert! t.strftime('%#Z') == "Europe/Warsaw"
			end
		end

		context "timezone offset", ->
			should "build", ->
				t := DateTime(2025, 10, 25, 14, 44, 13, zone: Timezone['Europe/Warsaw'])
				assert! t.strftime("%z") == "+0200"
			end
		end

		context "timezone offset colon", ->
			should "build", ->
				t := DateTime(2025, 10, 25, 14, 44, 13, zone: Timezone['Europe/Warsaw'])
				assert! t.strftime("%:z") == "+02:00"
			end
		end

	end

	context "+", ->
		should "add a datetime span", ->
			d := DateTime(
				year: 1999,
				month: 2,
				day: 20,
				hour: 13,
				minute: 38,
				second: 10,
			)

			expected := DateTime(
				year: 1999,
				month: 3,
				day: 20,
				hour: 15,
				minute: 38,
				second: 10,
			)
			assert! d + DateTime::Span(months: 1, hours: 2) == expected
		end

		should "add a date span", ->
			d := DateTime(
				year: 1999,
				month: 2,
				day: 20,
				hour: 13,
				minute: 38,
				second: 10,
			)

			expected := DateTime(
				year: 2000,
				month: 2,
				day: 20,
				hour: 13,
				minute: 38,
				second: 10,
			)
			assert! d + 1.year == expected
		end

		should "add a time span", ->
			d := DateTime(
				year: 1999,
				month: 2,
				day: 20,
				hour: 13,
				minute: 38,
				second: 10,
			)

			expected := DateTime(
				year: 1999,
				month: 2,
				day: 20,
				hour: 14,
				minute: 38,
				second: 10,
			)
			assert! d + 1.hour == expected
		end
	end

	context "-", ->
		should "return a DateTime when other is a date span", ->
			d := DateTime(
				year: 1999,
				month: 2,
				day: 20,
				hour: 13,
				minute: 38,
				second: 10,
			)
			expected := DateTime(
				year: 1998,
				month: 2,
				day: 20,
				hour: 13,
				minute: 38,
				second: 10,
			)
			assert! d - 1.year == expected
		end

		should "return a DateTime when other is a datetime span", ->
			d := DateTime(
				year: 1999,
				month: 2,
				day: 20,
				hour: 13,
				minute: 38,
				second: 10,
			)
			expected := DateTime(
				year: 1997,
				month: 2,
				day: 20,
				hour: 13,
				minute: 28,
				second: 10,
			)
			assert! d - DateTime::Span(years: 2, minutes: 10) == expected
		end

		should "return a positive DateTime when other is a time span", ->
			d := DateTime(
				year: 1999,
				month: 2,
				day: 20,
				hour: 13,
				minute: 38,
				second: 10,
			)
			expected := DateTime(
				year: 1999,
				month: 2,
				day: 20,
				hour: 8,
				minute: 38,
				second: 10,
			)
			assert! d - 5.hours == expected
		end

		should "return a positive datetime span when other is a DateTime", ->
			d := DateTime(
				year: 1999,
				month: 2,
				day: 20,
				hour: 13,
				minute: 38,
				second: 10,
			)
			other := DateTime(
				year: 1997,
				month: 5,
				hour: 8,
			)
			assert! d - other == 1.year + 9.months + 19.days + 5.hours + 38.minutes + 10.second
		end

		should "return a negative datetime span when other is a DateTime", ->
			d := DateTime(
				year: 1999,
				month: 2,
				day: 20,
			)
			assert! d - DateTime(year: 2005, month: 2, day: 20) == DateTime::Span(years: -6)
		end

		should "return a positive datetime span when other is a Date", ->
			d := DateTime(
				year: 1999,
				month: 2,
				day: 20,
				hour: 13,
				minute: 38,
				second: 10,
			)
			other := Date(
				year: 1997,
				month: 5,
			)
			assert! d - other == 1.year + 9.months + 19.days + 13.hours + 38.minutes + 10.second
		end

	end

	context "diff", ->
		context "date", ->
			should "return a positive datetime span", ->
				d := DateTime(
					year: 1999,
					month: 2,
					day: 20,
					hour: 13,
					minute: 38,
					second: 10,
				)
				other := Date(
					year: 1997,
					month: 5,
				)
				assert! d.diff(other) == 1.year + 9.months + 19.days + 13.hours + 38.minutes + 10.second
			end

			should "return a negative datetime span", ->
				d := DateTime(
					year: 1999,
					month: 2,
					day: 20,
					hour: 13,
					minute: 38,
					second: 10,
				)
				other := Date(
					year: 2005,
					month: 5,
				)
				assert! d.diff(other) == -6.years - 3.months + 19.days + 13.hour + 38.minutes + 10.seconds
			end
		end

		context "datetime", ->
			should "return a positive datetime span", ->
				d := DateTime(
					year: 1999,
					month: 2,
					day: 20,
					hour: 13,
					minute: 38,
					second: 10,
				)
				other := DateTime(year: 1990)
				assert! d.diff(other) == DateTime::Span(years: 9, months: 1, days: 19, hours: 13, minutes: 38, seconds: 10)
			end

			should "return a negative datetime span", ->
				d := DateTime(
					year: 1999,
					month: 2,
					day: 20,
					hour: 13,
					minute: 38,
					second: 10,
				)
				other := DateTime(year: 2005, month: 2, day: 20)
				assert! d.diff(other) == DateTime::Span(years: -6, hours: 13, minutes: 38, seconds: 10)
			end
		end
	end

	context "date", ->
		should "return the date component", ->
			d := DateTime(
				year: 1999,
				month: 2,
				day: 20,
				hour: 13,
				minute: 38,
				second: 10,
			)
			date := Date(
				year: 1999,
				month: 2,
				day: 20,
			)
			assert! d.to_date == date
		end
	end

	context "time", ->
		should "return the time component", ->
			d := DateTime(
				year: 1999,
				month: 2,
				day: 20,
				hour: 13,
				minute: 38,
				second: 10,
			)
			time := Time(
				hour: 13,
				minute: 38,
				second: 10,
			)
			assert! d.to_time == time
		end
	end

	context "to_datetime", ->
		should "return self", ->
			d := DateTime(
				year: 1999,
				month: 2,
				day: 20,
				hour: 13,
				minute: 38,
				second: 10,
			)
			assert! d.to_datetime == d
		end
	end

	context "zone", ->
		should "return the local timezone by default", ->
			d := DateTime(
				year: 1999,
				month: 2,
				day: 20,
				hour: 13,
				minute: 38,
				second: 10,
			)
			assert! d.zone == Timezone::LOCAL
		end

		should "return the set timezone", ->
			d := DateTime(
				year: 1999,
				month: 2,
				day: 20,
				hour: 13,
				minute: 38,
				second: 10,
				zone: Timezone::UTC
			)
			assert! d.zone == Timezone::UTC
		end
	end

	context "zone_name", ->
		should "return the local name by default", ->
			d := DateTime(
				year: 1999,
				month: 2,
				day: 20,
				hour: 13,
				minute: 38,
				second: 10,
			)
			assert! d.zone_name == "Local"
		end

		should "return the set UTC name", ->
			d := DateTime(
				year: 1999,
				month: 2,
				day: 20,
				hour: 13,
				minute: 38,
				second: 10,
				zone: Timezone::UTC
			)
			assert! d.zone_name == "UTC"
		end

		should "return a custom timezone name", ->
			d := DateTime(
				year: 1999,
				month: 2,
				day: 20,
				hour: 13,
				minute: 38,
				second: 10,
				zone: Timezone['Europe/Warsaw']
			)
			assert! d.zone_name == 'Europe/Warsaw'
		end
	end

	context "zone_offset", ->
		should "return the UTC offset", ->
			d := DateTime(
				year: 2025,
				month: 2,
				day: 20,
				hour: 13,
				minute: 38,
				second: 10,
				zone: Timezone::UTC
			)
			assert! d.zone_offset == 0.hours
		end

		should "return the standard offset", ->
			d := DateTime(
				year: 2025,
				month: 12,
				day: 20,
				hour: 13,
				minute: 38,
				second: 10,
				zone: Timezone["Europe/Warsaw"]
			)
			assert! d.zone_offset == 1.hours
		end

		should "return the DST offset", ->
			d := DateTime(
				year: 2025,
				month: 6,
				day: 20,
				hour: 13,
				minute: 38,
				second: 10,
				zone: Timezone["Europe/Warsaw"]
			)
			assert! d.zone_offset == 2.hours
		end
	end

	context "to_string", ->
		should "convert to string", ->
			d := DateTime(
				year: 2025,
				month: 2,
				day: 20,
				hour: 13,
				minute: 38,
				second: 10,
				zone: Timezone::UTC
			)
			assert! d.to_string == "2025-02-20 13:38:10.000000000 +00:00"
		end
	end

	context "year", ->
		should "return the year component", ->
			d := DateTime(
				year: 2025,
				month: 2,
				day: 20,
				hour: 13,
				minute: 38,
				second: 10,
				zone: Timezone::UTC
			)
			assert! d.year == 2025
		end
	end

	context "iso_year", ->
		should "return the previous year", ->
			d := DateTime(
				year: 2023,
				month: 1,
				day: 1,
			)
			assert! d.iso_year == 2022
		end

		should "return the current year", ->
			d := DateTime(
				year: 2026,
				month: 1,
				day: 1,
			)
			assert! d.iso_year == 2026
		end
	end

	context "iso_year_last_two", ->
		should "return the previous year", ->
			d := DateTime(
				year: 2023,
				month: 1,
				day: 1,
			)
			assert! d.iso_year_last_two == 22
		end

		should "return the current year", ->
			d := DateTime(
				year: 2026,
				month: 1,
				day: 1,
			)
			assert! d.iso_year_last_two == 26
		end
	end

	context "week_from_monday", ->
		should "return 0 for first partial week", ->
			d := DateTime(
				year: 2025,
				month: 1,
				day: 1,
			)
			assert! d.week_from_monday == 0
		end

		should "return a valid calculated week", ->
			d := DateTime(
				year: 2025,
				month: 4,
				day: 26,
			)
			assert! d.week_from_monday == 16
		end
	end

	context "week_from_sunday", ->
		should "return 0 for first partial week", ->
			d := DateTime(
				year: 2025,
				month: 1,
				day: 1,
			)
			assert! d.week_from_sunday == 0
		end

		should "return a valid calculated week", ->
			d := DateTime(
				year: 2025,
				month: 4,
				day: 27,
			)
			assert! d.week_from_sunday == 17
		end
	end

	context "iso_week", ->
		should "return 52 for first week of gregorian year", ->
			d := DateTime(
				year: 2023,
				month: 1,
				day: 1,
			)
			assert! d.iso_year == 2022
			assert! d.iso_week == 52
		end

		should "return a valid calculated week", ->
			d := DateTime(
				year: 2025,
				month: 4,
				day: 27,
			)
			assert! d.iso_week == 17
		end
	end

	context "year_day", ->
		should "return 1 for first day", ->
			d := DateTime(
				year: 2023,
				month: 1,
				day: 1,
			)
			assert! d.year_day == 1
		end

		should "return a valid calculated day", ->
			d := DateTime(
				year: 2025,
				month: 4,
				day: 27,
			)
			assert! d.year_day == 117
		end
	end

	context "iso_year_day", ->
		should "return 1 for first day", ->
			d := DateTime(
				year: 2023,
				month: 1,
				day: 1,
			)
			assert! d.iso_year == 2022
			assert! d.iso_year_day == 363
		end

		should "return a valid calculated day", ->
			d := DateTime(
				year: 2025,
				month: 4,
				day: 27,
			)
			assert! d.iso_year == 2025
			assert! d.iso_year_day == 118
		end
	end

	context "weekday_name", ->
		should "return the weekday name", ->
			d := DateTime(
				year: 2025,
				month: 11,
				day: 14,
			)
			assert! d.weekday_name == "Friday"
		end
	end

	context "abbreviated_weekday_name", ->
		should "return the weekday name", ->
			d := DateTime(
				year: 2025,
				month: 11,
				day: 14,
			)
			assert! d.abbreviated_weekday_name == "Fri"
		end
	end

	context "weekday_from_monday", ->
		should "return 7 for sunday", ->
			d := DateTime(
				year: 2025,
				month: 11,
				day: 16,
			)
			assert! d.weekday_from_monday == 7
		end

		should "return the weekday number", ->
			d := DateTime(
				year: 2025,
				month: 11,
				day: 14,
			)
			assert! d.weekday_from_monday == 5
		end
	end

	context "weekday_from_sunday", ->
		should "return 0 for sunday", ->
			d := DateTime(
				year: 2025,
				month: 11,
				day: 16,
			)
			assert! d.weekday_from_sunday == 0
		end

		should "return the weekday number", ->
			d := DateTime(
				year: 2025,
				month: 11,
				day: 14,
			)
			assert! d.weekday_from_sunday == 5
		end
	end

	context "is_monday", ->
		should "return true for monday", ->
			d := DateTime(
				year: 2025,
				month: 11,
				day: 10,
			)
			assert! d.is_monday == true
		end

		should "return false for other days", ->
			d := DateTime(
				year: 2025,
				month: 11,
				day: 13,
			)
			assert! d.is_monday == false
		end
	end

	context "is_tuesday", ->
		should "return true for tuesday", ->
			d := DateTime(
				year: 2025,
				month: 11,
				day: 11,
			)
			assert! d.is_tuesday == true
		end

		should "return false for other days", ->
			d := DateTime(
				year: 2025,
				month: 11,
				day: 13,
			)
			assert! d.is_tuesday == false
		end
	end

	context "is_wednesday", ->
		should "return true for wednesday", ->
			d := DateTime(
				year: 2025,
				month: 11,
				day: 12,
			)
			assert! d.is_wednesday == true
		end

		should "return false for other days", ->
			d := DateTime(
				year: 2025,
				month: 11,
				day: 13,
			)
			assert! d.is_wednesday == false
		end
	end

	context "is_thursday", ->
		should "return true for thursday", ->
			d := DateTime(
				year: 2025,
				month: 11,
				day: 13,
			)
			assert! d.is_thursday == true
		end

		should "return false for other days", ->
			d := DateTime(
				year: 2025,
				month: 11,
				day: 9,
			)
			assert! d.is_thursday == false
		end
	end

	context "is_friday", ->
		should "return true for friday", ->
			d := DateTime(
				year: 2025,
				month: 11,
				day: 14,
			)
			assert! d.is_friday == true
		end

		should "return false for other days", ->
			d := DateTime(
				year: 2025,
				month: 11,
				day: 9,
			)
			assert! d.is_friday == false
		end
	end

	context "is_saturday", ->
		should "return true for saturday", ->
			d := DateTime(
				year: 2025,
				month: 11,
				day: 15,
			)
			assert! d.is_saturday == true
		end

		should "return false for other days", ->
			d := DateTime(
				year: 2025,
				month: 11,
				day: 9,
			)
			assert! d.is_saturday == false
		end
	end

	context "is_sunday", ->
		should "return true for sunday", ->
			d := DateTime(
				year: 2025,
				month: 11,
				day: 16,
			)
			assert! d.is_sunday == true
		end

		should "return false for other days", ->
			d := DateTime(
				year: 2025,
				month: 11,
				day: 10,
			)
			assert! d.is_sunday == false
		end
	end

	context "hour", ->
		should "return the hour component", ->
			t := DateTime(
				year: 2025,
				month: 11,
				day: 10,
				hour: 15,
				minute: 59,
				second: 20,
				millisecond: 5,
				microsecond: 985,
				nanosecond: 500
			)
			assert! t.hour == 15
		end
	end

	context "hour12", ->
		should "return unchanged hour under 12", ->
			t := DateTime(
				year: 2025,
				month: 11,
				day: 10,
				hour: 8,
				minute: 59,
				second: 20,
				millisecond: 5,
				microsecond: 985,
				nanosecond: 500
			)
			assert! t.hour12 == 8
		end

		should "return clamped hour over 12", ->
			t := DateTime(
				year: 2025,
				month: 11,
				day: 10,
				hour: 15,
				minute: 59,
				second: 20,
				millisecond: 5,
				microsecond: 985,
				nanosecond: 500
			)
			assert! t.hour12 == 3
		end
	end

	context "meridiem", ->
		should "return PM", ->
			t := DateTime(
				year: 2025,
				month: 11,
				day: 10,
				hour: 15,
				minute: 59,
				second: 20,
			)
			assert! t.meridiem == "PM"
		end

		should "return AM", ->
			t := DateTime(
				year: 2025,
				month: 11,
				day: 10,
				hour: 8,
				minute: 59,
				second: 20,
			)
			assert! t.meridiem == "AM"
		end

		should "return AM for 24:00", ->
			t := DateTime(
				year: 2025,
				month: 11,
				day: 10,
				hour: 24,
			)
			assert! t.meridiem == "AM"
		end

		should "return PM for 12:00", ->
			t := DateTime(
				year: 2025,
				month: 11,
				day: 10,
				hour: 12,
			)
			assert! t.meridiem == "PM"
		end
	end

	context "minute", ->
		should "return the minute component", ->
			t := DateTime(
				year: 2025,
				month: 11,
				day: 10,
				hour: 15,
				minute: 59,
				second: 20,
				millisecond: 5,
				microsecond: 985,
				nanosecond: 500
			)
			assert! t.minute == 59
		end
	end

	context "second", ->
		should "return the second component", ->
			t := DateTime(
				year: 2025,
				month: 11,
				day: 10,
				hour: 15,
				minute: 59,
				second: 20,
				millisecond: 5,
				microsecond: 985,
				nanosecond: 500
			)
			assert! t.second == 20
		end
	end

	context "millisecond", ->
		should "return the millisecond component", ->
			t := DateTime(
				year: 2025,
				month: 11,
				day: 10,
				hour: 15,
				minute: 59,
				second: 20,
				millisecond: 5,
				microsecond: 985,
				nanosecond: 500
			)
			assert! t.millisecond == 5
		end
	end

	context "microsecond", ->
		should "return the microsecond component", ->
			t := DateTime(
				year: 2025,
				month: 11,
				day: 10,
				hour: 15,
				minute: 59,
				second: 20,
				millisecond: 5,
				microsecond: 985,
				nanosecond: 500
			)
			assert! t.microsecond == 985
		end
	end

	context "microseconds_in_second", ->
		should "return the microsecond component when no milliseconds", ->
			t := DateTime(
				year: 2025,
				month: 11,
				day: 10,
				hour: 15,
				minute: 59,
				second: 20,
				microsecond: 985,
				nanosecond: 500
			)
			assert! t.microseconds_in_second == 985
		end

		should "return combined milliseconds and microseconds", ->
			t := DateTime(
				year: 2025,
				month: 11,
				day: 10,
				hour: 15,
				minute: 59,
				second: 20,
				millisecond: 235,
				microsecond: 985,
				nanosecond: 500
			)
			assert! t.microseconds_in_second == 235_985
		end
	end

	context "nanosecond", ->
		should "return the nanosecond component", ->
			t := DateTime(
				year: 2025,
				month: 11,
				day: 10,
				hour: 15,
				minute: 59,
				second: 20,
				millisecond: 5,
				microsecond: 985,
				nanosecond: 500
			)
			assert! t.nanosecond == 500
		end
	end

	context "nanoseconds_in_second", ->
		should "return the nanosecond component", ->
			t := DateTime(
				year: 2025,
				month: 11,
				day: 10,
				hour: 15,
				minute: 59,
				second: 20,
				nanosecond: 500
			)
			assert! t.nanoseconds_in_second == 500
		end

		should "return combined subseconds", ->
			t := DateTime(
				year: 2025,
				month: 11,
				day: 10,
				hour: 15,
				minute: 59,
				second: 20,
				millisecond: 235,
				microsecond: 985,
				nanosecond: 500
			)
			assert! t.nanoseconds_in_second == 235_985_500
		end
	end

	context "picoseconds_in_second", ->
		should "return the nanosecond component", ->
			t := DateTime(
				year: 2025,
				month: 11,
				day: 10,
				hour: 15,
				minute: 59,
				second: 20,
				nanosecond: 500
			)
			assert! t.picoseconds_in_second == 500_000
		end

		should "return combined subseconds", ->
			t := DateTime(
				year: 2025,
				month: 11,
				day: 10,
				hour: 15,
				minute: 59,
				second: 20,
				millisecond: 235,
				microsecond: 985,
				nanosecond: 500
			)
			assert! t.picoseconds_in_second == 235_985_500_000
		end
	end

	context "femtoseconds_in_second", ->
		should "return the nanosecond component", ->
			t := DateTime(
				year: 2025,
				month: 11,
				day: 10,
				hour: 15,
				minute: 59,
				second: 20,
				nanosecond: 500
			)
			assert! t.femtoseconds_in_second == 500_000_000
		end

		should "return combined subseconds", ->
			t := DateTime(
				year: 2025,
				month: 11,
				day: 10,
				hour: 15,
				minute: 59,
				second: 20,
				millisecond: 235,
				microsecond: 985,
				nanosecond: 500
			)
			assert! t.femtoseconds_in_second == 235_985_500_000_000
		end
	end

	context "attoseconds_in_second", ->
		should "return the nanosecond component", ->
			t := DateTime(
				year: 2025,
				month: 11,
				day: 10,
				hour: 15,
				minute: 59,
				second: 20,
				nanosecond: 500
			)
			assert! t.attoseconds_in_second == 500_000_000_000
		end

		should "return combined subseconds", ->
			t := DateTime(
				year: 2025,
				month: 11,
				day: 10,
				hour: 15,
				minute: 59,
				second: 20,
				millisecond: 235,
				microsecond: 985,
				nanosecond: 500
			)
			assert! t.attoseconds_in_second == 235_985_500_000_000_000
		end
	end

	context "zeptoseconds_in_second", ->
		should "return the nanosecond component", ->
			t := DateTime(
				year: 2025,
				month: 11,
				day: 10,
				hour: 15,
				minute: 59,
				second: 20,
				nanosecond: 500
			)
			assert! t.zeptoseconds_in_second == 500_000_000_000_000
		end

		should "return combined subseconds", ->
			t := DateTime(
				year: 2025,
				month: 11,
				day: 10,
				hour: 15,
				minute: 59,
				second: 20,
				millisecond: 235,
				microsecond: 985,
				nanosecond: 500
			)
			assert! t.zeptoseconds_in_second == 235_985_500_000_000_000_000
		end
	end

	context "yoctoseconds_in_second", ->
		should "return the nanosecond component", ->
			t := DateTime(
				year: 2025,
				month: 11,
				day: 10,
				hour: 15,
				minute: 59,
				second: 20,
				nanosecond: 500
			)
			assert! t.yoctoseconds_in_second == 500_000_000_000_000_000
		end

		should "return combined subseconds", ->
			t := DateTime(
				year: 2025,
				month: 11,
				day: 10,
				hour: 15,
				minute: 59,
				second: 20,
				millisecond: 235,
				microsecond: 985,
				nanosecond: 500
			)
			assert! t.yoctoseconds_in_second == 235_985_500_000_000_000_000_000
		end
	end

	context "yoctoseconds_in_second", ->
		should "return the nanosecond component", ->
			t := DateTime(
				year: 2025,
				month: 11,
				day: 10,
				hour: 15,
				minute: 59,
				second: 20,
				nanosecond: 500
			)
			assert! t.yoctoseconds_in_second == 500_000_000_000_000_000
		end

		should "return combined subseconds", ->
			t := DateTime(
				year: 2025,
				month: 11,
				day: 10,
				hour: 15,
				minute: 59,
				second: 20,
				millisecond: 235,
				microsecond: 985,
				nanosecond: 500
			)
			assert! t.yoctoseconds_in_second == 235_985_500_000_000_000_000_000
		end
	end

	context "<=>", ->
		context "date argument", ->
			should "return 1 for greater", ->
				d := DateTime(
					year: 2025,
					month: 11,
					day: 10,
				)
				assert! d <=> Date(2025, 10, 15) == 1
			end

			should "return 0 for equal", ->
				d := DateTime(
					year: 2025,
					month: 11,
					day: 10,
				)
				assert! d <=> Date(2025, 11, 10) == 0
			end

			should "return -1 for less", ->
				d := DateTime(
					year: 2025,
					month: 11,
					day: 10,
				)
				assert! d <=> Date(2025, 12, 4) == -1
			end
		end

		context "datetime argument", ->
			should "return 1 for greater", ->
				d := DateTime(
					year: 2025,
					month: 11,
					day: 10,
				)
				assert! d <=> DateTime(2025, 10, 15) == 1
			end

			should "return 0 for equal", ->
				d := DateTime(
					year: 2025,
					month: 11,
					day: 10,
				)
				assert! d <=> DateTime(2025, 11, 10) == 0
			end

			should "return -1 for less", ->
				d := DateTime(
					year: 2025,
					month: 11,
					day: 10,
				)
				assert! d <=> DateTime(2025, 12, 4) == -1
			end
		end
	end

	context ">=", ->
		context "date argument", ->
			should "return true for greater", ->
				d := DateTime(
					year: 2025,
					month: 11,
					day: 10,
				)
				assert! d >= Date(2025, 10, 15) == true
			end

			should "return true for equal", ->
				d := DateTime(
					year: 2025,
					month: 11,
					day: 10,
				)
				assert! d >= Date(2025, 11, 10) == true
			end

			should "return false for less", ->
				d := DateTime(
					year: 2025,
					month: 11,
					day: 10,
				)
				assert! d >= Date(2025, 12, 4) == false
			end
		end

		context "datetime argument", ->
			should "return true for greater", ->
				d := DateTime(
					year: 2025,
					month: 11,
					day: 10,
				)
				assert! d >= DateTime(2025, 10, 15) == true
			end

			should "return true for equal", ->
				d := DateTime(
					year: 2025,
					month: 11,
					day: 10,
				)
				assert! d >= DateTime(2025, 11, 10) == true
			end

			should "return false for less", ->
				d := DateTime(
					year: 2025,
					month: 11,
					day: 10,
				)
				assert! d >= DateTime(2025, 12, 4) == false
			end
		end
	end

	context ">", ->
		context "date argument", ->
			should "return true for greater", ->
				d := DateTime(
					year: 2025,
					month: 11,
					day: 10,
				)
				assert! d > Date(2025, 10, 15) == true
			end

			should "return false for equal", ->
				d := DateTime(
					year: 2025,
					month: 11,
					day: 10,
				)
				assert! d > Date(2025, 11, 10) == false
			end

			should "return false for less", ->
				d := DateTime(
					year: 2025,
					month: 11,
					day: 10,
				)
				assert! d > Date(2025, 12, 4) == false
			end
		end

		context "datetime argument", ->
			should "return true for greater", ->
				d := DateTime(
					year: 2025,
					month: 11,
					day: 10,
				)
				assert! d > DateTime(2025, 10, 15) == true
			end

			should "return false for equal", ->
				d := DateTime(
					year: 2025,
					month: 11,
					day: 10,
				)
				assert! d > DateTime(2025, 11, 10) == false
			end

			should "return false for less", ->
				d := DateTime(
					year: 2025,
					month: 11,
					day: 10,
				)
				assert! d > DateTime(2025, 12, 4) == false
			end
		end
	end

	context "<=", ->
		context "date argument", ->
			should "return false for greater", ->
				d := DateTime(
					year: 2025,
					month: 11,
					day: 10,
				)
				assert! d <= Date(2025, 10, 15) == false
			end

			should "return true for equal", ->
				d := DateTime(
					year: 2025,
					month: 11,
					day: 10,
				)
				assert! d <= Date(2025, 11, 10) == true
			end

			should "return true for less", ->
				d := DateTime(
					year: 2025,
					month: 11,
					day: 10,
				)
				assert! d <= Date(2025, 12, 4) == true
			end
		end

		context "datetime argument", ->
			should "return false for greater", ->
				d := DateTime(
					year: 2025,
					month: 11,
					day: 10,
				)
				assert! d <= DateTime(2025, 10, 15) == false
			end

			should "return true for equal", ->
				d := DateTime(
					year: 2025,
					month: 11,
					day: 10,
				)
				assert! d <= DateTime(2025, 11, 10) == true
			end

			should "return true for less", ->
				d := DateTime(
					year: 2025,
					month: 11,
					day: 10,
				)
				assert! d <= DateTime(2025, 12, 4) == true
			end
		end
	end

	context "<", ->
		context "date argument", ->
			should "return false for greater", ->
				d := DateTime(
					year: 2025,
					month: 11,
					day: 10,
				)
				assert! d < Date(2025, 10, 15) == false
			end

			should "return false for equal", ->
				d := DateTime(
					year: 2025,
					month: 11,
					day: 10,
				)
				assert! d < Date(2025, 11, 10) == false
			end

			should "return true for less", ->
				d := DateTime(
					year: 2025,
					month: 11,
					day: 10,
				)
				assert! d < Date(2025, 12, 4) == true
			end
		end

		context "datetime argument", ->
			should "return false for greater", ->
				d := DateTime(
					year: 2025,
					month: 11,
					day: 10,
				)
				assert! d < DateTime(2025, 10, 15) == false
			end

			should "return false for equal", ->
				d := DateTime(
					year: 2025,
					month: 11,
					day: 10,
				)
				assert! d < DateTime(2025, 11, 10) == false
			end

			should "return true for less", ->
				d := DateTime(
					year: 2025,
					month: 11,
					day: 10,
				)
				assert! d < DateTime(2025, 12, 4) == true
			end
		end
	end

end
